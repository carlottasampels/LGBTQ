---
title: "Descriptives table"
author: ""
date: "2025-03-16"
output:
  html_document:
    toc: true
    toc_depth: 4
    number_sections: true
    toc_float:
      collapsed: false
      smooth_scroll: false
    df_print: paged
editor_options: 
  markdown: 
    wrap: 72
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Clear Global Environment
```{r clear global environment}
rm(list = ls(all.names = TRUE)) 
```

Read in file with path to ilovedata channel on Teams
Ensure that your credentials directory is correctly located
```{r Read in paths file}
source(file = "credentials/paths.R")
```

Add the add_numeric function - used to convert character variables into numeric variables.
Add the sumscores function - used to generate sumscores
Add the package_check function - used to install and load dependencies
```{r Read in functions}
source(file = paste0(ilovedata_scripts, "functions/add_numeric.R"))
source(file = paste0(ilovedata_scripts, "functions/remove_duplicates.R"))
source(file = paste0(ilovedata_scripts, "functions/sumscores.R"))
source(file = paste0(ilovedata_scripts, "functions/package_check.R"))
source(file = paste0(ilovedata_scripts, "functions/imp_check.R"))
source(file = paste0(ilovedata_scripts, "functions/recode_check.R"))
```

Load packages

```{r Load packages}
library(flextable)
library(officer)
library(dplyr)
library(gtsummary)
library(gt)
library(tidyverse)
```

## Set current date

```{r current date}
date <- Sys.Date()
```

## Load data

```{r Load data}
dat_sexual_orientation <- read_rds(
  file =
    paste0(filepath_cleaned_data,"dat_after_exclusion_sexual_orientation", date, ".rds")
)
```

```{r Load data gender}
dat_gender <- read_rds(
  file =
    paste0(filepath_cleaned_data,"dat_after_exclusion_gender", date, ".rds")
)
```

```{r Gender trans person}
#dat <- dat %>%
 # mutate(gender = case_when(
  #  gender == "Trans man" ~ "Trans person",
   # gender == "Trans woman" ~ "Trans person",
    #TRUE ~ gender
  #))
```

```{r Gender trans person}
#dat_gender <- dat_gender %>%
 # mutate(gender = case_when(
  #  gender == "Trans man" ~ "Trans person",
   # gender == "Trans woman" ~ "Trans person",
    #TRUE ~ gender
  #))
```

```{r Gender check}
dat_gender %>%
  freq(gender)
dat_sexual_orientation %>%
  freq(gender)
```

# dat_demographics

```{r dat_demographics}
dat_gender_demographics <- dat_gender %>%
  select(
    age,
    sex,
    gender,
    ethnicity,
    sexual_orientation,
    height_m,
    bmi,
    dem.highest_education_collapsed,
    #phq9.sum_score,
    #gad7.sum_score,
    any_mdd_diagnosis,
    any_gad_diagnosis,
    phq.Q9_suicidality_binary,
    mhd.mdd,
    mhd.gad,
    mhd.social_anxiety,
    mhd.specific_phobia,
    mhd.agoraphobia,
    #mhd.panic_disorder,
    mhd.panic_attacks,
    mhd.bipolar_disorder,
    mhd.ocd,
    mhd.bdd,
    mhd.an,
    mhd.atypical_an,
    mhd.bn,
    mhd.bed
  )
```

# Variable names

```{r variable names}
names(dat_gender_demographics)
```

# Demographics whole sample

```{r demographics whole sample}
summary_table_whole_sample <-
  dat_gender_demographics %>%
  gtsummary::tbl_summary(
    label = list(
      gender = "Gender",
      sex = "Biological sex",
      age = "Age [years]",
      ethnicity = "Ethnicity",
      sexual_orientation = "Sexual orientation",
      height_m = "Height [m]",
      bmi = "BMI [kg/m2]",
      dem.highest_education_collapsed = "Highest education",
      phq9.sum_score = "PHQ9 score",
      gad7.sum_score = "GAD7 score",
      phq.Q9_suicidality_binary = "Suicidality",
      mhd.mdd = "Major depressive disorder",
      mhd.gad = "Generalised anxiety disorder",
      mhd.social_anxiety = "Social anxiety",
      mhd.specific_phobia = "Specific phobia",
      mhd.agoraphobia = "Agoraphobia",
      #mhd.panic_disorder = "Panic disorder",
      mhd.panic_attacks = "Panic attacks",
      mhd.bipolar_disorder ="Bipolar disorder",
      mhd.ocd = "Obsessive-compulsive disorder",
      mhd.bdd = "Body dysmorphic disorder",
      mhd.an = "Anorexia nervosa", 
      mhd.atypical_an = "Atypical anorexia nervosa",
      mhd.bn = "Bulimia nervosa",
      mhd.bed = "Binge-eating disorder"
      ),
    type = list(
      gender = "categorical",
      dem.sex = "categorical",
      age = "continuous2",
      ethnicity = "categorical",
      sexual_orientation = "categorical",
      height_m = "continuous2",
      bmi = "continuous2",
      dem.highest_education_collapsed = "categorical",
      phq9.sum_score = "continuous2",
      gad7.sum_score = "continuous2",
      phq.Q9_suicidality_binary = "dichotomous",
      mhd.mdd = "dichotomous",
      mhd.gad = "dichotomous",
      mhd.social_anxiety = "dichotomous",
      mhd.specific_phobia = "dichotomous",
      mhd.agoraphobia = "dichotomous",
      #mhd.panic_disorder = "dichotomous",
      mhd.panic_attacks = "dichotomous",
      mhd.bipolar_disorder = "dichotomous",
      mhd.ocd = "dichotomous",
      mhd.bdd = "dichotomous",
      mhd.an = "dichotomous",
      mhd.atypical_an = "dichotomous",
      mhd.bn = "dichotomous",
      mhd.bed = "dichotomous"
      ),
    value = list(
      phq.Q9_suicidality_binary = "Any suicidality",
      mhd.mdd = "MDD",
      mhd.gad = "GAD",
      mhd.social_anxiety = "Social anxiety",
      mhd.specific_phobia = "Specific phobia",
      mhd.agoraphobia = "Agoraphobia",
      #mhd.panic_disorder = "Panic disorder",
      mhd.panic_attacks = "Panic attacks",
      mhd.bipolar_disorder = "Bipolar disorder",
      mhd.ocd = "OCD",
      mhd.bdd = "BDD",
      mhd.an = "AN", 
      mhd.atypical_an = "Atypical AN",
      mhd.bn = "BN",
      mhd.bed = "BED"
      ),
    missing_text = "Not answered",
    digits = list(
      all_categorical() ~ c(0, 1),
      all_dichotomous() ~ c(0, 1)),
    
    statistic = list(
      all_categorical() ~ "{n} ({p}%)",
      all_continuous() ~ c("{mean} ({sd})", "{median} ({p25}, {p75})",  "{min} - {max}")
      )
    ) %>%
  bold_labels()

summary_table_whole_sample
```


## Save as a word document

```{r word properties 1}
sect_properties1 <- officer::prop_section(
  page_size = page_size(
    orient = "portrait",
    width = 8.3,
    height = 11.7
  ),
  type = "continuous",
  page_margins = page_mar()
)
```


```{r summary_table_whole_sample as word document}
summary_table_whole_sample %>%
  as_flex_table() %>%
  flextable::save_as_docx(
    path = paste0(LGBTQ_folder, "tables/", date, "/LGBTQ_descriptives", date, ".docx"),
    pr_section = sect_properties1
  )
```

```{r Deutsche Namen}
#Sexual Orientation
dat_sexual_orientation <- within(dat_sexual_orientation, {
  sexual_orientation <- factor(
    sexual_orientation,
    levels = c("Heterosexual", "Homosexual", "Bisexual", "Self-define", "Asexual"),
    labels = c("Heterosexuell", "Homosexuell", "Bisexuell", "Selbstdefiniert", "Asexuell")
  )
  gender <- factor(
    gender,
    levels = c("Cis woman", "Cis man", "Non-binary", "Trans man", "Self-define", "Trans woman"),
    labels = c("Cis Frau", "Cis Mann", "Nicht-Binär", "Trans Mann", "Selbstdefiniert", "Trans Frau")
  )
  dem.highest_education_collapsed <- factor(
    dem.highest_education_collapsed,
    levels = c("None of the above", "GCSEs/CSEs/O-levels or equivalent", "NVQ/HND/HNC or equivalent", "A-levels/AS-levels or equivalent", "University"),
    labels = c("Keine der genannten Optionen", "GCSEs/CSEs/O-levels oder Äquivalent", "NVQ/HND/HNC oder Äquivalent", "A-levels/AS-levels oder Äquivalent", "Universität")
  )
  ethniscity <- factor(
    ethnicity,
    levels = c("White", "Not white"),
    labels = c("Weiß", "Nicht-weiß")
  )
  sex <- factor (
    sex,
    levels = c("Male", "Female"),
    labels = c("Männlich", "Weiblich")
  )
})


#Gender
dat_gender <- within(dat_gender, {
  sexual_orientation <- factor(
    sexual_orientation,
    levels = c("Heterosexual", "Homosexual", "Bisexual", "Self-define", "Asexual"),
    labels = c("Heterosexuell", "Homosexuell", "Bisexuell", "Selbstdefiniert", "Asexuell")
  )
gender <- factor(
  gender,
  levels = c("Cis woman", "Cis man", "Non-binary", "Trans man", "Self-define", "Trans woman"),
  labels = c("Cis Frau", "Cis Mann", "Nicht-Binär", "Trans Mann", "Selbstdefiniert", "Trans Frau")
)
  dem.highest_education_collapsed <- factor(
    dem.highest_education_collapsed,
    levels = c("None of the above", "GCSEs/CSEs/O-levels or equivalent", "NVQ/HND/HNC or equivalent", "A-levels/AS-levels or equivalent", "University"),
    labels = c("Keine der genannten Optionen", "GCSEs/CSEs/O-levels oder Äquivalent", "NVQ/HND/HNC oder Äquivalent", "A-levels/AS-levels oder Äquivalent", "Universität")
  )
  ethnicity <- factor(
    ethnicity,
    levels = c("White", "Not white"),
    labels = c("Weiß", "Nicht-weiß")
  )
    sex <- factor (
    sex,
    levels = c("Male", "Female"),
    labels = c("Männlich", "Weiblich")
  )
})
```

# Table clinically significant


```{r dat_demographics_clinical}
dat_demographics_clinical_sexual_orientation <- dat_sexual_orientation %>%
  select(
    sex,
    gender,
    ethnicity,
    sexual_orientation,
    dem.highest_education_collapsed,
    #cidid.mdd_diagnosis,
    #cidia.diagnosis,
    #mhd.mdd,
    #mhd.gad,
    any_mdd_diagnosis,
    any_gad_diagnosis,
    mhd.social_anxiety,
    mhd.specific_phobia,
    mhd.agoraphobia,
    #mhd.panic_disorder,
    mhd.panic_attacks,
    mhd.bipolar_disorder,
    mhd.ocd,
    mhd.bdd,
    mhd.an,
    mhd.atypical_an,
    mhd.bn,
    mhd.bed,
    phq.Q9_suicidality_binary
  )
```

```{r dat_demographics_clinical_gender}
dat_demographics_clinical_gender <- dat_gender %>%
  select(
    sex,
    gender,
    ethnicity,
    sexual_orientation,
    dem.highest_education_collapsed,
    #cidid.mdd_diagnosis,
    #cidia.diagnosis,
    #mhd.mdd,
    #mhd.gad,
    any_mdd_diagnosis,
    any_gad_diagnosis,
    mhd.social_anxiety,
    mhd.specific_phobia,
    mhd.agoraphobia,
    #mhd.panic_disorder,
    mhd.panic_attacks,
    mhd.bipolar_disorder,
    mhd.ocd,
    mhd.bdd,
    mhd.an,
    mhd.atypical_an,
    mhd.bn,
    mhd.bed,
    phq.Q9_suicidality_binary
  )
```

```{r}
summary_table_clinical_gender <-
  dat_demographics_clinical_gender %>%
  gtsummary::tbl_summary(
    by = gender, 
    missing = "no",
    label = list(
#      sex = "Biological sex",
 #     sexual_orientation = "Sexual orientation",
  #    ethnicity = "Ethnicity",
   #   dem.highest_education_collapsed = "Highest education",
    #  any_mdd_diagnosis = "Major depressive disorder",
     # any_gad_diagnosis = "Generalised anxiety disorder",
      #mhd.social_anxiety = "Social Anxiety",
#      mhd.specific_phobia = "Specific phobia",
 #     mhd.agoraphobia = "Agoraphobia",
  #    mhd.panic_disorder = "Panic disorder",
   #   mhd.panic_attacks = "Panic attacks",
    #  mhd.bipolar_disorder ="Bipolar disorder",
     # mhd.ocd = "Obsessive-compulsive disorder",
      #mhd.bdd = "Body dysmorphic disorder",
#      mhd.an = "Anorexia nervosa", 
 #     mhd.atypical_an = "Atypical anorexia nervosa",
  #    mhd.bn = "Bulimia nervosa",
   #   mhd.bed = "Binge-eating disorder",
    #  phq.Q9_suicidality_binary = "Suicidality"
     
      sex = "Biologisches Geschlecht",
      gender = "Geschlechtsidentität",
      ethnicity = "Ethnizität",
      dem.highest_education_collapsed = "Höchster Bildungsabschluss",
      any_mdd_diagnosis = "Schwere depressive Störung",
      any_gad_diagnosis = "Generalisierte Angststörung",
      mhd.social_anxiety = "Soziale Angststörung",
      mhd.specific_phobia = "Spezifische Phobie",
      mhd.agoraphobia = "Agoraphobie",
      mhd.panic_disorder = "Panik Störung",
      mhd.panic_attacks = "Panik Atacken",
      mhd.bipolar_disorder ="Bipolare Störung",
      mhd.ocd = "Zwangsstörung",
      mhd.bdd = "Körpersysmorphe Störung",
      mhd.an = "Anorexia nervosa", 
      mhd.atypical_an = "Atypische anorexia nervosa",
      mhd.bn = "Bulimia nervosa",
      mhd.bed = "Binge-eating Störung",
      phq.Q9_suicidality_binary = "Suizidaliät"
       ),
    type = list(
      sex = "categorical",
      gender = "categorical",
      sexual_orientation = "categorical",
      
      dem.highest_education_collapsed = "categorical",
      #phq9.sum_score = "continuous2",
      #gad7.sum_score = "continuous2",
      #cidid.mdd_diagnosis = "dichotomous",
      #cidia.diagnosis = "dichotomous",
      #mhd.mdd = "dichotomous",
      #mhd.gad = "dichotomous",
      any_mdd_diagnosis = "dichotomous",
      any_gad_diagnosis = "dichotomous",
      mhd.social_anxiety = "dichotomous",
      mhd.specific_phobia = "dichotomous",
      mhd.agoraphobia = "dichotomous",
      mhd.panic_disorder = "dichotomous",
      mhd.panic_attacks = "dichotomous",
      mhd.bipolar_disorder = "dichotomous",
      mhd.ocd = "dichotomous",
      mhd.bdd = "dichotomous",
      mhd.an = "dichotomous", 
      mhd.atypical_an = "dichotomous",
      mhd.bn = "dichotomous",
      mhd.bed = "dichotomous",
      phq.Q9_suicidality_binary = "dichotomous"
      ),
    value = list(
      #cidid.mdd_diagnosis = "MDD diagnosis",
      #cidia.diagnosis = "GAD diagnosis",
      #mhd.mdd = "MDD",
      #mhd.gad = "GAD",
      any_mdd_diagnosis = "MDD",
      any_gad_diagnosis = "GAD",
      mhd.social_anxiety = "Social anxiety",
      mhd.specific_phobia = "Specific phobia",
      mhd.agoraphobia = "Agoraphobia",
      mhd.panic_disorder = "Panic disorder",
      mhd.panic_attacks = "Panic attacks",
      mhd.bipolar_disorder ="Bipolar disorder",
      mhd.ocd = "OCD",
      mhd.bdd = "BDD",
      mhd.an = "AN", 
      mhd.atypical_an = "Atypical AN",
      mhd.bn = "BN",
      mhd.bed = "BED",
      phq.Q9_suicidality_binary = "Any suicidality"
      ),
    #missing_text = "Not answered",
    digits = list(
      all_categorical() ~ c(0, 1),
      all_dichotomous() ~ c(0, 1)),
    
    statistic = list(
      all_categorical() ~ "{n} ({p}%)",
      all_continuous() ~ c("{mean} ({sd})", "{median} ({p25}, {p75})",  "{min} - {max}")
      )
    ) %>%
  add_p() %>%
  add_overall()

summary_table_clinical_gender
```

```{r}
summary_table_clinical_sexual_orientation <-
  dat_demographics_clinical_sexual_orientation %>%
  gtsummary::tbl_summary(
    by = sexual_orientation, 
    missing = "no",
    label = list(
      #sex = "Biological sex",
      #gender = "Gender",
      #ethnicity = "Ethnicity",
      #dem.highest_education_collapsed = "Highest education",
      #any_mdd_diagnosis = "Major depressive disorder",
      #any_gad_diagnosis = "Generalised anxiety disorder",
      #mhd.social_anxiety = "Social Anxiety",
      #mhd.specific_phobia = "Specific phobia",
      #mhd.agoraphobia = "Agoraphobia",
      #mhd.panic_disorder = "Panic disorder",
      #mhd.panic_attacks = "Panic attacks",
      #mhd.bipolar_disorder ="Bipolar disorder",
      #mhd.ocd = "Obsessive-compulsive disorder",
      #mhd.bdd = "Body dysmorphic disorder",
      #mhd.an = "Anorexia nervosa", 
      #mhd.atypical_an = "Atypical anorexia nervosa",
      #mhd.bn = "Bulimia nervosa",
      #mhd.bed = "Binge-eating disorder",
      #phq.Q9_suicidality_binary = "Suicidality"
      #sex = "Biological sex",
      #gender = "Gender",
      #ethnicity = "Ethnicity",
      #dem.highest_education_collapsed = "Highest education",
      
      sex = "Biologisches Geschlecht",
      gender = "Geschlechtsidentität",
      ethnicity = "Ethnizität",
      dem.highest_education_collapsed = "Höchster Bildungsabschluss",
      any_mdd_diagnosis = "Schwere depressive Störung",
      any_gad_diagnosis = "Generalisierte Angststörung",
      mhd.social_anxiety = "Soziale Angststörung",
      mhd.specific_phobia = "Spezifische Phobie",
      mhd.agoraphobia = "Agoraphobie",
      mhd.panic_disorder = "Panik Störung",
      mhd.panic_attacks = "Panik Atacken",
      mhd.bipolar_disorder ="Bipolare Störung",
      mhd.ocd = "Zwangsstörung",
      mhd.bdd = "Körpersysmorphe Störung",
      mhd.an = "Anorexia nervosa", 
      mhd.atypical_an = "Atypische anorexia nervosa",
      mhd.bn = "Bulimia nervosa",
      mhd.bed = "Binge-eating Störung",
      phq.Q9_suicidality_binary = "Suizidaliät"
      ),
    type = list(
      sex = "categorical",
      gender = "categorical",
      ethnicity = "categorical",
      sexual_orientation = "categorical",
      dem.highest_education_collapsed = "categorical",
      #cidid.mdd_diagnosis = "dichotomous",
      #cidia.diagnosis = "dichotomous",
      #mhd.mdd = "dichotomous",
      #mhd.gad = "dichotomous",
      any_mhd_diagnosis = "dichotomous",
      any_gad_diagnosis = "dichotomous",
      mhd.social_anxiety = "dichotomous",
      mhd.specific_phobia = "dichotomous",
      mhd.agoraphobia = "dichotomous",
      mhd.panic_disorder = "dichotomous",
      mhd.panic_attacks = "dichotomous",
      mhd.bipolar_disorder = "dichotomous",
      mhd.ocd = "dichotomous",
      mhd.bdd = "dichotomous",
      mhd.an = "dichotomous", 
      mhd.atypical_an = "dichotomous",
      mhd.bn = "dichotomous",
      mhd.bed = "dichotomous",
      phq.Q9_suicidality_binary = "dichotomous"
      ),
    value = list(
      #cidid.mdd_diagnosis = "MDD diagnosis",
      #cidia.diagnosis = "GAD diagnosis",
      #mhd.mdd = "MDD",
      #mhd.gad = "GAD",
      any_mdd_diagnosis = "MDD",
      any_gad_diagnosis = "GAD",
      mhd.social_anxiety = "Social anxiety",
      mhd.specific_phobia = "Specific phobia",
      mhd.agoraphobia = "Agoraphobia",
      mhd.panic_disorder = "Panic disorder",
      mhd.panic_attacks = "Panic attacks",
      mhd.bipolar_disorder ="Bipolar disorder",
      mhd.ocd = "OCD",
      mhd.bdd = "BDD",
      mhd.an = "AN", 
      mhd.atypical_an = "Atypical AN",
      mhd.bn = "BN",
      mhd.bed = "BED",
       phq.Q9_suicidality_binary = "Any suicidality"
      ),
    #missing_text = "Not answered",
    digits = list(
      all_categorical() ~ c(0, 1),
      all_dichotomous() ~ c(0, 1)),
    
    statistic = list(
      all_categorical() ~ "{n} ({p}%)",
      all_continuous() ~ c("{mean} ({sd})", "{median} ({p25}, {p75})",  "{min} - {max}")
      )
    ) %>%
  add_p() %>%
  add_overall()

summary_table_clinical_sexual_orientation
```

```{r geändert} 
summary_table_clinical <-
  dat_demographics_clinical_sexual_orientation %>%
  gtsummary::tbl_summary(
    label = list(
      #sex = "Biological sex",
      #gender = "Gender",
      #sexual_orientation = "Sexual orientation",
      #any_mdd_diagnosis = "Major depressive disorder",
      #any_gad_diagnosis = "Generalised anxiety disorder",
      #mhd.social_anxiety = "Social Anxiety",
      #mhd.specific_phobia = "Specific phobia",
      #mhd.agoraphobia = "Agoraphobia",
      #mhd.panic_disorder = "Panic disorder",
      #mhd.panic_attacks = "Panic attacks",
      #mhd.bipolar_disorder ="Bipolar disorder",
      #mhd.ocd = "Obsessive-compulsive disorder",
      #mhd.bdd = "Body dysmorphic disorder",
      #mhd.an = "Anorexia nervosa", 
      #mhd.atypical_an = "Atypical anorexia nervosa",
      #mhd.bn = "Bulimia nervosa",
      #mhd.bed = "Binge-eating disorder",
      #phq.Q9_suicidality_binary = "Suicidality",
      #dem.highest_education_collapsed = "Highest education",
      #ethnicity = "Ethnicity"
      sex = "Biologisches Geschlecht",
      gender = "Geschlechtsidentität",
      ethnicity = "Ethnizität",
      dem.highest_education_collapsed = "Höchster Bildungsabschluss",
      any_mdd_diagnosis = "Schwere depressive Störung",
      any_gad_diagnosis = "Generalisierte Angststörung",
      mhd.social_anxiety = "Soziale Angststörung",
      mhd.specific_phobia = "Spezifische Phobie",
      mhd.agoraphobia = "Agoraphobie",
      mhd.panic_disorder = "Panik Störung",
      mhd.panic_attacks = "Panik Atacken",
      mhd.bipolar_disorder ="Bipolare Störung",
      mhd.ocd = "Zwangsstörung",
      mhd.bdd = "Körpersysmorphe Störung",
      mhd.an = "Anorexia nervosa", 
      mhd.atypical_an = "Atypische anorexia nervosa",
      mhd.bn = "Bulimia nervosa",
      mhd.bed = "Binge-eating Störung",
      phq.Q9_suicidality_binary = "Suizidaliät"
      ),
    type = list(
      sex = "categorical",
      gender = "categorical",
      sexual_orientation = "categorical",
      #cidid.mdd_diagnosis = "dichotomous",
      #cidia.diagnosis = "dichotomous",
      #mhd.mdd = "dichotomous",
      #mhd.gad = "dichotomous",
      any_mdd_diagnosis = "dichotomous",
      any_gad_diagnosis = "dichotomous",
      mhd.social_anxiety = "dichotomous",
      mhd.specific_phobia = "dichotomous",
      mhd.agoraphobia = "dichotomous",
      mhd.panic_disorder = "dichotomous",
      mhd.panic_attacks = "dichotomous",
      mhd.bipolar_disorder = "dichotomous",
      mhd.ocd = "dichotomous",
      mhd.bdd = "dichotomous",
      mhd.an = "dichotomous", 
      mhd.atypical_an = "dichotomous",
      mhd.bn = "dichotomous",
      mhd.bed = "dichotomous",
      phq.Q9_suicidality_binary = "dichotomous",
      dem.highest_education_collapsed = "categorical",
      ethnicity = "categorical"
      ),
    value = list(
      #cidid.mdd_diagnosis = "MDD diagnosis",
      #cidia.diagnosis = "GAD diagnosis",
      #mhd.mdd = "MDD",
      #mhd.gad = "GAD",
      any_mdd_diagnosis = "MDD",
      any_gad_diagnosis = "GAD",
      mhd.social_anxiety = "Social anxiety",
      mhd.specific_phobia = "Specific phobia",
      mhd.agoraphobia = "Agoraphobia",
      mhd.panic_disorder = "Panic disorder",
      mhd.panic_attacks = "Panic attacks",
      mhd.bipolar_disorder ="Bipolar disorder",
      mhd.ocd = "OCD",
      mhd.bdd = "BDD",
      mhd.an = "AN", 
      mhd.atypical_an = "Atypical AN",
      mhd.bn = "BN",
      mhd.bed = "BED",
      phq.Q9_suicidality_binary = "Any suicidality"
      ),
    missing_text = "Not answered",
    digits = list(
      all_categorical() ~ c(0, 1),
      all_dichotomous() ~ c(0, 1)),
    
    statistic = list(
      all_categorical() ~ "{n} ({p}%)",
      all_continuous() ~ c("{mean} ({sd})", "{median} ({p25}, {p75})",  "{min} - {max}")
      )
    )

summary_table_clinical
```

## Word document

```{r word properties}
sect_properties_landscape <- officer::prop_section(
  page_size = page_size(
    orient = "landscape",
    width = 8.3,
    height = 11.7
  ),
  type = "continuous",
  page_margins = page_mar()
)
```

```{r summary_table_clinical_gender as word document}
summary_table_clinical_gender %>%
  as_flex_table() %>%
  flextable::save_as_docx(
    path = paste0(LGBTQ_folder, "tables/", date, "/LGBTQ_descriptives_clin_gender", date, ".docx"),
    pr_section = sect_properties_landscape
  )
```

```{r summary_table_clinical_sexual_orientation as word document}
summary_table_clinical_sexual_orientation %>%
  as_flex_table() %>%
  flextable::save_as_docx(
    path = paste0(LGBTQ_folder, "tables/", date, "/LGBTQ_descriptives_clin_sexual_orientation", date, ".docx"),
    pr_section = sect_properties_landscape
  )
```

```{r summary_table_clinical as word document}
summary_table_clinical %>%
  flextable::save_as_docx(
    path = paste0(LGBTQ_folder, "tables/", date, "/LGBTQ_descriptives_clin", date, ".docx"),
    pr_section = sect_properties_landscape
  )

```