---
title: "MHD Cleaning Script"
author: "Zain Ahmad"
date: "30/11/2022"
output: html_document
---

## Standards
All arguments should be in their own row, including the first argument
Closing bracket should have its own row
Functions with a single argument can have this on the same line
One argument can be hashed out per line for debugging errors

Chunk names should be all lower case except:
Study name (e.g. GLAD/EDGI/EDGI ED) all caps
Capitalised first word
Chunk names MUST be unique

Add only one empty line between chunks
Add one extra line when starting a new section
Use hash syntax as appropriate for headings and subheadings, as per markdown syntax

Points requiring user input are enclosed thus <>

Ensure that you have deleted/untracked .DS_Store before your initial commit
Ensure that your  .gitignore contains "**/.DS_Store" before your initial commit

Configure global options for all chunks
```{r Setup, include=FALSE}
knitr::opts_chunk$set(
  echo = TRUE,
  comment = '',
  prompt = FALSE,
  cache = FALSE
  )
```

Clear global environment prior to initiation
```{r Clear global environment}
remove(list = ls())
```

Read in file with path to ilovedata channel on Teams
Ensure that your credentials directory is correctly located
```{r Read in paths file}
source(file = "credentials/paths.R")
```

Add the add_labelled_numeric function - used to convert character variables into numeric variables
Add the remove_duplicates function - used to deduplicate and remove NAs from IDs
Add the sumscores function - used to generate sumscores
Add the package_check function - used to install and load dependencies
Add the recode_check function - used to check for implausible values when recoding
Add the imp_clean function - used to check variables for implausible values
Add the cont_clean function - used to check continuous variables for implausible values
```{r Read in functions}
source(file = paste0(ilovedata_scripts, "functions/add_labelled_numeric.R"))
source(file = paste0(ilovedata_scripts, "functions/remove_duplicates.R"))
source(file = paste0(ilovedata_scripts, "functions/sumscores.R"))
source(file = paste0(ilovedata_scripts, "functions/package_check.R"))
source(file = paste0(ilovedata_scripts, "functions/recode_check.R"))
source(file = paste0(ilovedata_scripts, "functions/cont_clean.R"))
source(file = paste0(ilovedata_scripts, "functions/replace_name.R"))
```

Use package_check to install and load dependencies
Load tidyverse last
```{r Install load dependencies}
packages <- c("sjlabelled",
              "Amelia",
              "gtsummary",
              "summarytools",
              "tidyverse")

package_check(packages)
```


Specify columns to be excluded from add_numeric function
Continuous variables should be excluded, as they are already numeric
Text variables also need to be excluded
Do not include ID and sample here
```{r Specify excluded columns}
exclude_cols_numeric <- c(
  "mhd.other_ocd_text.txt",
  "mhd.other_text.txt"

  )
```

#Read in the dictionary with old and new variable names
- For phenotype with existing cleaning scripts in before 2023 July, you need to replace the new variable names with the old variable names before running cleaning scripts. 
- For cleaning scripts developed after 2023 July, recommend to use the new variable names (do not need this step).

```{r read in dictionary to replace variable names}
tep<-readRDS(
  file = paste0(
    ilovedata, "/data_raw/latest_freeze/dict_map_variable_names_2023.rds")
  )

```


# Read in the data: Mental Health Disorders Questionnaire
Change this heading to the name of your questionnaire/demographic
Load GLAD data first, then EDGI, then EDGI ED, then RAMP

Do not change variable names from the NLP names that are produced by the extraction
EXCEPT in exceptional circumstances
Document ANY changes to variable names in the issues spreadsheet "https://docs.google.com/spreadsheets/d/1a2gL8c0eH2pZXNTbnPzkDYQGeeVXbLKU8BUpYM0moe8/edit?usp=sharing"

- For created variable names, use ONLY 'questionnaire.variable_name'
- For dataset, only use snake_case naming
- When using pipe operator '%>%', each function should begin on a new line
- Do not add empty lines at the beginning or end of a chunk
- Use only tidyverse functions wherever possible
- When naming chunks, begin with the name of the dataset (GLAD, EDGI, EDGI ED, RAMP) where appropriate

## GLAD data
```{r GLAD load data}
glad_dat <- read_rds(
  file = paste0(ilovedata, "/data_raw/2022-09-16/glad/mhd_glad.rds")
  )

#replace variable names 
glad_dat<-replace_variable_names(glad_dat,tep)

# Check variable names in dataframe
glad_dat %>%
  colnames()

# Inspect dimensions of dataframe
glad_dat %>%
  dim()

# Report counts of duplicates in ID column
glad_dat %>%
  select(externalDataReference) %>%
  filter(duplicated(.)) %>%
  count(., externalDataReference)

# Report number of IDs to be dropped
glad_excluded <- glad_dat %>%
  select(externalDataReference) %>%
  filter(duplicated(.)) %>%
  count(., externalDataReference) %>%
  select("GLAD Dropped IDs" = "n") %>%
  colSums() + 1

#glad_excluded
```

Create list of all labels and attributes
This chunk supersedes all categorical/numeric cleaning
It gives you an output of c(the question label, all value-label pairs)
for each variable
Check for errors in the output of this chunk, including:
- Label spelling errors (for questions and answers)
- Incorrect values
- Mismatches between labels and values
- Scale errors
- Variable naming issues from the data extraction
- Any other issues you can see
All issues/changes need to be logged as a to-do on Teams with yourself and Saakshi/Mika tagged
At this point, you also need to pick out any continuous, date or text variables
to be cleaned in the later chunks
```{r GLAD List labels attrs}
label_list_glad <- sapply(glad_dat, function(x) c(attr(x, "label"), attr(x, "labels")))
#label_list_glad
```


Select/rename relevant columns and de-duplicate/NA-remove ID column
NB: If this is data from the COPING survey, add "_cop" to the end of each variable name, including startDate/endDate
```{r GLAD select}
glad_dat_id <- glad_dat %>% #new dataset with ID
  remove_duplicates("externalDataReference") %>% # Remove duplicate IDs
  add_column(sample = "GLAD",
             .after = "externalDataReference") %>% # Create new sample column
  dplyr::select(
    ID = externalDataReference, # ID
    sample,
    startDate,                                              
    endDate,

    mhd.mental_distress_prevented_usual,
    mhd.seek_receive_professional_life,

    # Depression, anxiety, OCD and PTSD related disorders
    mhd.mdd,                                
    mhd.perinatal_depression,                
    mhd.pmdd,                               
    mhd.bipolar_disorder,                    
    mhd.gad,                                
    mhd.social_anxiety,                      
    mhd.specific_phobia,                    
    mhd.agoraphobia,                         
    mhd.panic_disorder,                     
    mhd.panic_attacks,                       
    mhd.ptsd,                              
    mhd.ocd,                                 
    mhd.bdd,                                
    mhd.other_ocd,                           
    mhd.other_ocd_text.txt,
    mhd.none_dep_anx_ocd_ptsd = mhd.none_of_the_above,# renamed to differentiate from other none of the above   
    mhd.dont_know_dep_anx_ocd_ptsd = mhd.dont_know,# renamed to differentiate from other don't know
    mhd.pnta_dep_anx_ocd_ptsd = mhd.prefer_not_to_answer,# renamed to differentiate from other PNTA

    # EDs and neurodevelopmental disorders
    mhd.an,                                 
    mhd.atypical_an,                         
    mhd.bn,                                 
    mhd.bed,                                 
    mhd.schizophrenia,                      
    mhd.schizoaffective,                     
    mhd.psychosis,
    mhd.personality_disorder,
    mhd.asd,                                
    mhd.addadhd,                            
    mhd.other,                              
    mhd.other_text.txt,                      
    mhd.none_neuro_eds = mhd.none_of_the_above.1,# renamed to differentiate from other none of the above
    mhd.dont_know_neuro_eds = mhd.dont_know.1,# renamed to differentiate from other don't know
    mhd.pnta_neuro_eds = mhd.prefer_not_to_answer.1,# renamed to differentiate from other PNTA  

    mhd.personality_disorder_diagnosed
  )  %>%
  add_labelled_numeric(exclude = exclude_cols_numeric)

# Inspect colnames
glad_dat_id %>%
  colnames()

# Inspect dimensions of new data set
glad_dat_id %>%
  dim()
```

Check missingness by missmap
```{r GLAD missmap}
glad_dat_id %>%
  missmap()
```


## EDGI data
Located in EDGI dem by mistake
```{r EDGI load data}
edgi_dat <- read_rds(
  file = paste0(ilovedata, "/data_raw/2022-09-16/edgi/dem_edgi.rds")
  )

#replace variable names 
edgi_dat<-replace_variable_names(edgi_dat,tep)
# Check variable names in dataframe
edgi_dat %>%
  colnames()

# Inspect dimensions of dataframe
edgi_dat %>%
  dim()

# Report counts of duplicates in ID column
edgi_dat %>%
  select(externalDataReference) %>%
  filter(duplicated(.)) %>%
  count(., externalDataReference)

# Report number of IDs to be dropped
edgi_excluded <- edgi_dat %>%
  select(externalDataReference) %>%
  filter(duplicated(.)) %>%
  count(., externalDataReference) %>%
  select("EDGI Dropped IDs" = "n") %>%
  colSums() + 1

#edgi_excluded
```

Create list of all labels and attributes
This chunk supersedes all categorical/numeric cleaning
It gives you an output of c(the question label, all value-label pairs)
for each variable
Check for errors in the output of this chunk, including:
- Label spelling errors (for questions and answers)
- Incorrect values
- Mismatches between labels and values
- Scale errors
- Variable naming issues from the data extraction
- Any other issues you can see
All issues/changes need to be logged as a to-do on Teams with yourself and Saakshi/Mika tagged
At this point, you also need to pick out any continuous, date or text variables
to be cleaned in the later chunks
```{r EDGI List labels attrs}
label_list_edgi <- sapply(edgi_dat, function(x) c(attr(x, "label"), attr(x, "labels")))
#label_list_edgi
```

Find differences between colnames of GLAD and EDGI dataframes
`setdiff()` gives the items in the first argument that are not in the second argument
Rename IF NECESSARY to be consistent with GLAD
```{r Check colnames EDGI}
setdiff(colnames(glad_dat_id), colnames(edgi_dat))
```

Select/rename relevant columns and de-duplicate/NA-remove ID column
NB: If this is data from the COPING survey, add "_cop" to the end of each variable name, including startDate/endDate
```{r EDGI select}
edgi_dat_id <- edgi_dat %>% #new dataset with ID
  remove_duplicates("externalDataReference") %>% # Remove duplicate IDs
  add_column(sample = "EDGI",
             .after = "externalDataReference") %>% # Create new sample column
  dplyr::select(
    ID = externalDataReference, # ID
    sample,
    startDate,                                              
    endDate,

    # Depression, anxiety, OCD and PTSD related disorders
    mhd.mdd = dem.depression,                                         
    mhd.perinatal_depression = dem.postnatalantenatal_depression,                      
    mhd.pmdd = dem.pmdd,                                               
    mhd.bipolar_disorder = dem.mania_hypomania_bipolar_or_manicdepression,         
    mhd.gad = dem.anxiety_nerves_or_generalised_anxiety_disorder,     
    mhd.social_anxiety = dem.social_anxiety_or_social_phobia,                    
    mhd.specific_phobia = dem.specific_phobia,                                    
    mhd.agoraphobia = dem.agoraphobia,                                        
    mhd.panic_attacks = dem.panic_attacks,                                     
    mhd.panic_disorder = dem.panic_disorder,                                     
    mhd.ptsd = dem.ptsd,
    mhd.ocd = dem.obsessivecompulsive_disorder_,                   
    mhd.bdd = dem.bdd,                                                
    mhd.other_ocd = dem.other_ocd,                                          
    mhd.none_dep_anx_ocd_ptsd = dem.none_of_the_above.1,# renamed to differentiate from other NOTA
    mhd.dont_know_dep_anx_ocd_ptsd = dem.dont_know,# renamed to differentiate from other don't know
    mhd.pnta_dep_anx_ocd_ptsd = dem.prefer_not_to_answer.1,# renamed to differentiate from other PNTA

    # Neurodevelopmental disorders
    mhd.schizophrenia = dem.schizophrenia,                                      
    mhd.psychosis = dem.psychosis_type_psychotic_illness,                   
    mhd.personality_disorder = dem.personality_disorder,                               
    mhd.asd = dem.autism_spectrum_disorder_,                       
    mhd.addadhd = dem.attention_deficit_hyperactivity_disorder,           
    mhd.other = dem.other.2,                                            
    mhd.othertext.txt = dem.othertext.txt.1,                                   
    mhd.none_neuro = dem.none_of_the_above.2,# renamed to differentiate from other none of the above
    mhd.dont_know_neuro = dem.dont_know.7,# renamed to differentiate from other don'tknow      
    mhd.pnta_neuro = dem.prefer_not_to_answer.4,# renamed to differentiate from other PNTA  
    
    # Which personality disorder do you have?
    mhd.personality_disorder_diagnosed = dem.personality_disorder_diagnosed
  )  %>%
  add_labelled_numeric(exclude = c("mhd.othertext.txt"))

# Inspect colnames
edgi_dat_id %>%
  colnames()

# Inspect dimensions of new data set
edgi_dat_id %>%
  dim()
```

Check missingness by missmap
```{r EDGI missmap}
edgi_dat_id %>%
  missmap()
```


## EDGI ED data
There are 2 EDGI datasets, as for some reason the eating disorders data was put in a separate questionnaire on Qualtrics
```{r EDGI ED load data}
edgi_ed_dat <- read_rds(
  file = paste0(ilovedata, "/data_raw/2022-09-16/edgi/mhd_edgi.rds")
  )


#replace variable names 
edgi_ed_dat<-replace_variable_names(edgi_ed_dat,tep)

# Check variable names in dataframe
edgi_ed_dat %>%
  colnames()

# Inspect dimensions of dataframe
edgi_ed_dat %>%
  dim()

# Report counts of duplicates in ID column
edgi_ed_dat %>%
  select(externalDataReference) %>%
  filter(duplicated(.)) %>%
  count(., externalDataReference)

# Report number of IDs to be dropped
edgi_ed_excluded <- edgi_ed_dat %>%
  select(externalDataReference) %>%
  filter(duplicated(.)) %>%
  count(., externalDataReference) %>%
  select("EDGI ED Dropped IDs" = "n") %>%
  colSums() + 1

#edgi_ed_excluded
```

Create list of all labels and attributes
This chunk supersedes all categorical/numeric cleaning
It gives you an output of c(the question label, all value-label pairs)
for each variable
Check for errors in the output of this chunk, including:
- Label spelling errors (for questions and answers)
- Incorrect values
- Mismatches between labels and values
- Scale errors
- Variable naming issues from the data extraction
- Any other issues you can see
All issues/changes need to be logged as a to-do on Teams with yourself and Saakshi/Mika tagged
At this point, you also need to pick out any continuous, date or text variables
to be cleaned in the later chunks
```{r EDGI ED List labels attrs}
label_list_edgi_ed <- sapply(edgi_ed_dat, function(x) c(attr(x, "label"), attr(x, "labels")))
#label_list_edgi_ed
```

Find differences between colnames of GLAD and EDGI ED dataframes
`setdiff()` gives the items in the first argument that are not in the second argument
Rename IF NECESSARY to be consistent with GLAD
```{r Check colnames EDGI ED}
setdiff(colnames(edgi_ed_dat), colnames(glad_dat))
```

Select/rename relevant columns and de-duplicate/NA-remove ID column
NB: If this is data from the COPING survey, add "_cop" to the end of each variable name, including startDate/endDate
```{r EDGI ED select}
edgi_ed_dat_id <- edgi_ed_dat %>% #new dataset with ID
  remove_duplicates("externalDataReference") %>% # Remove duplicate IDs
  add_column(sample = "EDGI",
             .after = "externalDataReference") %>% # Create new sample column
  dplyr::select(
    ID = externalDataReference, # ID
    sample,
    startDate,                                              
    endDate,       

    # EDs
    mhd.suspected_eating_disorder_diagnosed,
    mhd.eating_disorder_received_treatment,           
    mhd.an = mhd.anorexia_nervosa,                            
    mhd.atypical_an = mhd.atypical_anorexia_nervosa,                    
    mhd.bn = mhd.bulimia_nervosa,                             
    mhd.atypical_bn = mhd.atypical_bulimia_nervosa,                     
    mhd.bed = mhd.bingeeating_disorder,                        
    mhd.atypical_bed = mhd.atypical_bingeeating_disorder,                
    mhd.purging_disorder,                            
    mhd.nighteating_syndrome = mhd.night_eating_syndrome,                        
    mhd.pica,                                        
    mhd.avoidantrestrictive_food_intake_disorder,     
    mhd.rumination_disorder,                         
    mhd.feeding_eating_disorder,                      
    mhd.other_eating_disorder,                       
    mhd.other_eating_disordertext.txt,            
    mhd.none_eds = mhd.none,# renamed to differentiate from GLAD none of the above      
    mhd.dont_know_eds = mhd.dont_know,# renamed to differentiate from GLAD don't know
    mhd.pnta_eds = mhd.prefer_not_to_answer,# renamed to differntiate from GLAD PNTA      

    # Questions about current or past experience of EDs
    mhd.people_thought_weigh_weighed,                 
    mhd.an_current_past = mhd.anorexia_nervosa.1,                          
    mhd.atypical_an_current_past = mhd.atypical_anorexia_nervosa.1,                  
    mhd.bn_current_past = mhd.bulimia_nervosa.1,                           
    mhd.atypical_bn_current_past = mhd.atypical_bulimia_nervosa.1,                   
    mhd.bed_current_past = mhd.bingeeating_disorder.1,   
    mhd.atypical_bed_current_past = mhd.atypical_bingeeating_disorder.1,
    mhd.purging_disorder_current_past = mhd.purging_disorder.1,
    mhd.nighteating_syndrome_current_past = mhd.nighteating_syndrome,
    mhd.pica_current_past = mhd.pica.1,
    mhd.avoidantrestrictive_food_intake_disorder_current_past = mhd.avoidantrestrictive_food_intake_disorder.1,
    mhd.rumination_disorder_current_past = mhd.rumination_eating_disorder,
    mhd.other_eating_disorder_current_past = mhd.other_eating_disorder.1,
    mhd.other_specified_feeding_or_eating_disorder_current_past = mhd.other_specified_feeding_or_eating_disorder
  )  %>%
   add_labelled_numeric(exclude = c("mhd.other_eating_disordertext.txt"))

# Inspect colnames
edgi_ed_dat_id %>%
  colnames()

# Inspect dimensions of new data set
edgi_ed_dat_id %>%
  dim()
```

Check missingness by missmap
```{r EDGI ED missmap}
edgi_ed_dat_id %>%
  missmap()
```

Merge the two EDGI datasets
```{r EDGI merge datasets}
edgi_dat_id_merged <- plyr::join_all(
  dfs = list(edgi_dat_id, edgi_ed_dat_id),
  by = c("ID", "sample"),
  type = "full"
  )

# Check
edgi_dat_id_merged %>%
  colnames()

edgi_dat_id_merged %>%
  dim()
```


# Combining Data

Bind rows of GLAD, EDGI, EDGI ED and RAMP data
Read in data, bind datasets, then clean all together
```{r Merge data sets}
dat <- glad_dat_id %>%
  bind_rows(edgi_dat_id_merged)

# Check dat using glimpse before continuing
dat %>% glimpse()
```

Recode Non-answer values to 3 digits
-555 'Not applicable' response from participant
-777 Seen but not answered
-888 Don't know
-999 Prefer not to answer/Prefer not to say
`NA` Were not shown the question (genuinely missing value)
When we code someone as being 'not applicable' by deduction, we use `NA_real_`
```{r Recode NA values}
dat <- dat %>%
  mutate(across(where(is.numeric),
                ~case_when(
                  . == -55 ~ -555,
                  . == -77 ~ -777,
                  . == -88 ~ -888,
                  . == -99 ~ -999,
                  TRUE ~ .)
                )
         )

```



# Cleaning Textual Variables

Create vector of text variables
```{r Vector text vars}
variables_text <- c(
  "mhd.other_ocd_text.txt",
  "mhd.other_text.txt"
)
```

View text variables
```{r Check text vars, eval=FALSE, include=FALSE}
dat %>%
  select(all_of(variables_text)) %>%
  tbl_summary(missing_text = "Missing")
```

# Grouping mental health disorders
Disorder groupings (from PANCHANGE analysis)
1. Depressive disorder group: major depression, antenatal/postnatal depression, premenstrual depression. The logic for this has been double checked for males - KT/MD.
2. Anxiety group: generalised anxiety, social anxiety, specific phobia, agoraphobia, panic_disorder, panic_attacks.
3. Agoraphobia and panic_disorder group: panic_disorder, agoraphobia, panic_attacks.
4. Eating disorders group: anorexianervosa, atypical anorexia nervosa, bulimia nervosa, overeating or bingeeating.
5. Obsessive complusive disorders: obsessive compulaive disorder, obsessive compulsive related disorders.
6. Psychotic disorders: schizophrenia, schizoaffective disorder, general psychosis or psychotic illness.
7. Personality disorders: cluster A, cluster B, cluster C
8. Control group: no diagnosed disorders.

```{r Specify cohorts}
GLAD = TRUE
EDGI = TRUE
NBR = FALSE
RAMP = FALSE
```

### Depressive disorders
Caveat: Perinatal depression item has flow logic meaning it is only shown to participants who answer 'Yes' to the question 'Have you ever been pregnant?'
PMDD item has flow logic meaning it is only shown to participants who answer 'Female' to the question 'What was your assigned sex at birth?'
```{r mhd depressive_disorders}
if(GLAD == TRUE | EDGI == TRUE | NBR == TRUE | RAMP == TRUE) {
dat <- dat %>%
  mutate(
    mhd.depressive_disorders_numeric =
      case_when(
        (mhd.mdd_numeric == "0" &
        (mhd.perinatal_depression_numeric == "0" | is.na(mhd.perinatal_depression_numeric)) &
        (mhd.pmdd_numeric == "0" | is.na(mhd.pmdd_numeric))) ~ 0,
        mhd.mdd_numeric == "1" ~ 1,
        mhd.perinatal_depression_numeric == "1" ~ 1,
        mhd.pmdd_numeric == "1" ~ 1))

dat <- dat %>%
  mutate(
    mhd.depressive_disorders =
      recode_factor(mhd.depressive_disorders_numeric,
                    "0" = "No depressive disorder",
                    "1" = "Depressive disorder",
                    missing = NA_character_
                    )
  )

dat %>%
  freq(mhd.depressive_disorders,
       cumul = F)
}
```

```{r Check depressive_disorders}
if(GLAD == TRUE | EDGI == TRUE | NBR == TRUE | RAMP == TRUE) {
dat %>%
  select(
    mhd.depressive_disorders,
    mhd.depressive_disorders_numeric,
    mhd.mdd,
    mhd.perinatal_depression,
    mhd.pmdd
  )
}
```

```{r mhd major_depressive_disorder}
if(GLAD == TRUE | EDGI == TRUE | NBR == TRUE | RAMP == TRUE) {
dat <- dat %>%
  mutate(
    mhd.major_depressive_disorder_numeric =
      case_when(
        (mhd.mdd_numeric == "0" ~ 0),
        (mhd.mdd_numeric == "1" ~ 1)
      )
  )

dat <- dat %>%
  mutate(
    mhd.major_depressive_disorder =
      recode_factor(mhd.major_depressive_disorder_numeric,
                    "0" = "No major depressive disorder",
                    "1" = "Major depressive disorder",
                    missing = NA_character_
      )
  )
dat %>%
  freq(mhd.major_depressive_disorder,
       cumul = F)
}
```

```{r Check major_depression_disorder}
if(GLAD == TRUE | EDGI == TRUE | NBR == TRUE | RAMP == TRUE) {
dat %>%
  select(
    mhd.mdd,
    mhd.major_depressive_disorder,
    mhd.major_depressive_disorder_numeric
  )
}
```

### Anxiety disorders
```{r mhd anxiety_disorders}
if(GLAD == TRUE | EDGI == TRUE | NBR == TRUE | RAMP == TRUE) {
dat <- dat %>%
  mutate(
    mhd.anxiety_disorders_numeric =
      case_when(
        mhd.gad_numeric == "1" ~ 1,
        mhd.social_anxiety_numeric == "1" ~ 1,
        mhd.specific_phobia_numeric == "1" ~ 1,
        mhd.agoraphobia_numeric == "1" ~ 1,
        mhd.panic_disorder_numeric == "1" ~ 1,
        mhd.panic_attacks_numeric == "1" ~ 1,
        (mhd.gad_numeric == "0" &
        mhd.social_anxiety_numeric == "0" &
        mhd.specific_phobia_numeric == "0" &
        mhd.agoraphobia_numeric == "0" &
        mhd.panic_disorder_numeric == "0" &
        mhd.panic_attacks_numeric == "0") ~ 0
      )
  )
dat <- dat %>%
  mutate(
    mhd.anxiety_disorders =
      recode_factor(mhd.anxiety_disorders_numeric,
                    "0" = "No anxiety disorder",
                    "1" = "Anxiety disorder",
                    missing = NA_character_
                    )
  )
dat %>%
  freq(mhd.anxiety_disorders,
       cumul = F)
}
```

A big proportion of the participants are NA for panic disorder.

```{r Check anxiety_disorders}
if(GLAD == TRUE | EDGI == TRUE | NBR == TRUE | RAMP == TRUE) {
dat %>%
  select(
    mhd.anxiety_disorders,
    mhd.anxiety_disorders_numeric,
    mhd.gad,
    mhd.social_anxiety,
    mhd.specific_phobia,
    mhd.agoraphobia,
    mhd.panic_disorder,
    mhd.panic_attacks
  ) %>%
    filter(mhd.panic_disorder == "Not Panic disorder")
}
```

Agoraphobia and panic disorder group
```{r mhd agoraphobia_panic_disorder}
if(GLAD == TRUE | EDGI == TRUE | NBR == TRUE | RAMP == TRUE) {
dat <- dat %>%
  mutate(
    mhd.agoraphobia_panic_disorder_numeric =
      case_when(
        mhd.agoraphobia_numeric == "1" ~ 1,
        mhd.panic_disorder_numeric == "1" ~ 1,
        mhd.panic_attacks_numeric == "1" ~ 1,
        (mhd.agoraphobia_numeric == "0" &
        mhd.panic_disorder_numeric == "0" &
        mhd.panic_attacks_numeric == "0") ~ 0
      )
  )
dat <- dat %>%
  mutate(
    mhd.agoraphobia_panic_disorder =
      recode_factor(mhd.agoraphobia_panic_disorder_numeric,
                    "0" = "No agoraphobia/panic disorder",
                    "1" = "Agoraphobia/panic disorder",
                    missing = NA_character_
                    )
  )
dat %>%
  freq(mhd.agoraphobia_panic_disorder)
}
```

```{r Check agoraphobia_panic_disorder}
if(GLAD == TRUE | EDGI == TRUE | NBR == TRUE | RAMP == TRUE) {
dat %>%
  select(
    mhd.agoraphobia_panic_disorder,
    mhd.agoraphobia_panic_disorder_numeric,
    mhd.agoraphobia,
    mhd.panic_disorder,
    mhd.panic_attacks
  )
}
```

Fear based group
```{r mhd fear_based_anxiety}
if(GLAD == TRUE | EDGI == TRUE | NBR == TRUE | RAMP == TRUE) {
dat <- dat %>%
  mutate(
    mhd.fear_based_anxiety_disorder_numeric =
      case_when(
        mhd.specific_phobia_numeric == "1" ~ 1,
        mhd.agoraphobia_numeric == "1" ~ 1,
        mhd.panic_disorder_numeric == "1" ~ 1,
        mhd.panic_attacks_numeric == "1" ~ 1,
        (mhd.specific_phobia_numeric == "0" &
        mhd.agoraphobia_numeric == "0" &
        mhd.panic_disorder_numeric == "0" &
        mhd.panic_attacks_numeric == "0") ~ 0
      )
  )
dat <- dat %>%
  mutate(
    mhd.fear_based_anxiety_disorder =
      recode_factor(mhd.fear_based_anxiety_disorder_numeric,
                    "0" = "No fear-based anxiety disorder",
                    "1" = "Fear-based anxiety disorder",
                    missing = NA_character_
                    )
  )
dat %>%
  freq(mhd.fear_based_anxiety_disorder)
}
```

```{r Check mhd fear_based_anxiety_disorder}
if(GLAD == TRUE | EDGI == TRUE | NBR == TRUE | RAMP == TRUE) {
dat %>%
  select(
    mhd.fear_based_anxiety_disorder,
    mhd.specific_phobia,
    mhd.agoraphobia,
    mhd.panic_disorder,
    mhd.panic_attacks
  )
}
```

worry based group
```{r mhd worry_based_anxiety}
if(GLAD == TRUE | EDGI == TRUE | NBR == TRUE | RAMP == TRUE) {
dat <- dat %>%
  mutate(
    mhd.worry_based_anxiety_disorder_numeric =
      case_when(
        mhd.gad_numeric == "1" ~ 1,
        mhd.social_anxiety_numeric == "1" ~ 1,
        (mhd.gad_numeric == "0" &
        mhd.social_anxiety_numeric== "0") ~ 0
      )
  )
dat <- dat %>%
  mutate(
    mhd.worry_based_anxiety_disorder =
      recode_factor(mhd.worry_based_anxiety_disorder_numeric,
                    "0" = "No worry-based anxiety disorder",
                    "1" = "Worry-based anxiety disorder",
                    missing = NA_character_
                    )
  )
dat %>%
  freq(mhd.worry_based_anxiety_disorder)
}
```

```{r Check mhd worry_based_anxiety_disorder}
if(GLAD == TRUE | EDGI == TRUE | NBR == TRUE | RAMP == TRUE) {
dat %>%
  select(
    mhd.worry_based_anxiety_disorder,
    mhd.gad,
    mhd.social_anxiety
  )
}
```

Depression and anxiety comorbidity
```{r mhd depression_anxiety}
if(GLAD == TRUE | EDGI == TRUE | NBR == TRUE | RAMP == TRUE) {
dat <- dat %>%
  mutate(
    mhd.depression_and_anxiety_numeric =
      case_when(
        mhd.depressive_disorders_numeric == 0 &
          mhd.anxiety_disorders_numeric == 0 ~ 0,
        mhd.depressive_disorders_numeric == 1 &
          mhd.anxiety_disorders_numeric == 1 ~ 1,
        mhd.depressive_disorders_numeric == 1 &
          mhd.anxiety_disorders_numeric == 0 ~ 2,
        mhd.depressive_disorders_numeric == 0 &
          mhd.anxiety_disorders_numeric == 1 ~ 3
      )
  )
dat <- dat %>%
  mutate(
    mhd.depression_and_anxiety =
      recode_factor(mhd.depression_and_anxiety_numeric,
                    "0" = "No depressive or anxiety disorder",
                    "1" = "Depressive and anxiety disorder",
                    "2" = "Only depressive disorder",
                    "3" = "Only anxiety disorder",
                    missing = NA_character_
                    )
  )
dat %>%
  freq(mhd.depression_and_anxiety,
       cumul = F)
}
```

### Eating disorders

There is routing questionnaire if participants have been diagnosed with an eating disorder and afterwards they get asked the specific disorders. Therefore, mhd.suspected_eating_disorder_diagnosed_numeric needs to be recoded as 0 otherwise they would be NAs.
```{r nbr cleaning eating disorders}
if(NBR == TRUE) {
#Recode as 0 if ppt responds no to screening question (mhd.suspected_eating_disorder_diagnosed_numeric)
dat <- dat %>%
  mutate(
    mhd.an_numeric =
      case_when(mhd.suspected_eating_disorder_diagnosed_numeric == "0" ~ 0,
                mhd.an_numeric == "0" ~ 0,
                mhd.an_numeric == "1" ~ 1),
    mhd.atypical_an_numeric =
      case_when(mhd.suspected_eating_disorder_diagnosed_numeric == "0" ~ 0,
                mhd.atypical_an_numeric == "0" ~ 0,
                mhd.atypical_an_numeric == "1" ~ 1),
    mhd.bn_numeric =
      case_when(mhd.suspected_eating_disorder_diagnosed_numeric == "0" ~ 0,
                mhd.bn_numeric == "0" ~ 0,
                mhd.bn_numeric == "1" ~ 1),
    mhd.bed_numeric =
      case_when(mhd.suspected_eating_disorder_diagnosed_numeric == "0" ~ 0,
                mhd.bed_numeric == "0" ~ 0,
                mhd.bed_numeric == "1" ~ 1),
    mhd.none_eds_numeric =
      case_when(mhd.suspected_eating_disorder_diagnosed_numeric == "0" ~ 0,
                mhd.none_eds_numeric == "0" ~ 0,
                mhd.none_eds_numeric == "1" ~ 1),
    mhd.dont_know_eds_numeric =
      case_when(mhd.suspected_eating_disorder_diagnosed_numeric == "0" ~ 0,
                mhd.dont_know_eds_numeric == "0" ~ 0,
                mhd.dont_know_eds_numeric == "1" ~ 1),
    mhd.pnta_eds_numeric =
      case_when(mhd.suspected_eating_disorder_diagnosed_numeric == "0" ~ 0,
                mhd.pnta_eds_numeric == "0" ~ 0,
                mhd.pnta_eds_numeric == "1" ~ 1),
    mhd.other_eating_disorder_numeric =
      case_when(mhd.suspected_eating_disorder_diagnosed_numeric == "0" ~ 0,
                mhd.other_eating_disorder_numeric == "0" ~ 0,
                mhd.other_eating_disorder_numeric == "1" ~ 1),
    mhd.an =
      case_when(mhd.suspected_eating_disorder_diagnosed_numeric == "0" ~ "Not Anorexia nervosa",
                mhd.an_numeric == "0" ~ "Not Anorexia nervosa",
                mhd.an_numeric == "1" ~ "Anorexia nervosa"),
    mhd.atypical_an =
      case_when(mhd.suspected_eating_disorder_diagnosed_numeric == "0" ~ "Not Atypical anorexia nervosa",
                mhd.atypical_an_numeric == "0" ~ "Not Atypical anorexia nervosa",
                mhd.atypical_an_numeric == "1" ~ "Atypical anorexia nervosa"),
    mhd.bn =
      case_when(mhd.suspected_eating_disorder_diagnosed_numeric == "0" ~ "Not Bulimia nervosa",
                mhd.bn_numeric == "0" ~ "Not Bulimia nervosa",
                mhd.bn_numeric == "1" ~ "Bulimia nervosa"),
    mhd.bed =
      case_when(mhd.suspected_eating_disorder_diagnosed_numeric == "0" ~ "Not Binge-eating disorder",
                mhd.bed_numeric == "0" ~ "Not Binge-eating disorder",
                mhd.bed_numeric == "1" ~ "Binge-eating disorder"),
    mhd.none_eds =
      case_when(mhd.suspected_eating_disorder_diagnosed_numeric == "0" ~ "Not None of the above",
                mhd.none_eds == "0" ~ "Not None of the above",
                mhd.none_eds == "1" ~ "None of the above"),
    mhd.dont_know_eds =
      case_when(mhd.suspected_eating_disorder_diagnosed_numeric == "0" ~ "Not Don't know",
                mhd.dont_know_eds_numeric == "0" ~ "Not Don't know",
                mhd.dont_know_eds_numeric == "1" ~ "Don't know"),
    mhd.pnta_eds =
      case_when(mhd.suspected_eating_disorder_diagnosed_numeric == "0" ~ "Not Prefer not to answer",
                mhd.pnta_eds_numeric == "0" ~ "Not Prefer not to answer",
                mhd.pnta_eds_numeric == "1" ~ "Prefer not to answer"),
    mhd.other_eating_disorder =
      case_when(mhd.suspected_eating_disorder_diagnosed_numeric == "0" ~ "Not Other eating disorder:",
                mhd.other_eating_disorder_numeric == "0" ~ "Not Other eating disorder:",
                mhd.other_eating_disorder_numeric == "1" ~ "Other eating disorder:")
    )
}
```

```{r mhd eating_disorders}
if(GLAD == TRUE | NBR == TRUE | RAMP == TRUE) {
dat <- dat %>%
  mutate(
    mhd.eating_disorders_numeric =
      case_when(
        mhd.an_numeric == "1" ~ 1,
        mhd.atypical_an_numeric == "1" ~ 1,
        mhd.bn_numeric == "1" ~ 1,
        mhd.bed_numeric == "1" ~ 1,
        (mhd.an_numeric == "0" &
        mhd.atypical_an_numeric == "0" &
        mhd.bn_numeric == "0" &
        mhd.bed_numeric == "0") ~ 0
      )
  )
dat <- dat %>%
  mutate(
    mhd.eating_disorders =
      recode_factor(mhd.eating_disorders_numeric,
                    "0" = "No eating disorder",
                    "1" = "Eating disorder",
                    missing = NA_character_
                    )
  )
dat %>%
  freq(mhd.eating_disorders,
       cumul = F)
}
```

For EDGI does not include other eating disorders, such as purging disorder, rumination disorder, ARFID, or Pica
```{r edgi mhd eating_disorders}
if(EDGI == TRUE) {
dat <- dat %>%
  mutate(
    mhd.eating_disorders_numeric =
      case_when(
        mhd.an_numeric == "1" ~ 1,
        mhd.atypical_an_numeric == "1" ~ 1,
        mhd.bn_numeric == "1" ~ 1,
        mhd.atypical_bn_numeric == "1" ~ 1, # additional diagnosis in EDGI but not in GLAD
        mhd.bed_numeric == "1" ~ 1,
        mhd.atypical_bed_numeric == "1" ~ 1, # additional diagnosis in EDGI
        (mhd.an_numeric == "0" &
        mhd.atypical_an_numeric == "0" &
        mhd.bn_numeric == "0" &
        (mhd.atypical_bn_numeric == "0" | is.na(mhd.atypical_bed_numeric)) &
        mhd.bed_numeric == "0" &
        (mhd.atypical_bed_numeric == "0"| is.na(mhd.atypical_bed_numeric))) ~ 0
      )
  )
dat <- dat %>%
  mutate(
    mhd.eating_disorders =
      recode_factor(mhd.eating_disorders_numeric,
                    "0" = "No eating disorder",
                    "1" = "Eating disorder",
                    missing = NA_character_
                    )
  )
dat %>%
  freq(mhd.eating_disorders,
       cumul = F)
}
```

```{r mhd anorexia_nervosa}
if(GLAD == TRUE | EDGI == TRUE | NBR == TRUE | RAMP == TRUE) {
dat <- dat %>%
  mutate(
    mhd.anorexia_nervosa_broad_numeric =
      case_when(
        mhd.an_numeric == "1" ~ 1,
        mhd.atypical_an_numeric == "1" ~ 1,
        (mhd.an_numeric == "0" &
        mhd.atypical_an_numeric == "0") ~ 0
      )
  )
dat <- dat %>%
  mutate(
    mhd.anorexia_nervosa =
      recode_factor(mhd.anorexia_nervosa_numeric,
                    "0" = "No anorexia nervosa",
                    "1" = "Anorexia nervosa",
                    missing = NA_character_
                    )
  )
dat %>%
  freq(mhd.anorexia_nervosa,
       cumul = F)
}
```

```{r mhd narrow_anorexia_nervosa}
if(GLAD == TRUE | EDGI == TRUE | NBR == TRUE | RAMP == TRUE) {
dat <- dat %>%
  mutate(
    mhd.narrow_anorexia_nervosa_numeric = 
      case_when(
        mhd.an_numeric == 1 & mhd.atypical_an_numeric == 0 ~ 1,
        mhd.an_numeric == 0 | mhd.atypical_an_numeric == 1 ~ 0
      )
  )
dat <- dat %>%
  mutate(
    mhd.narrow_anorexia_nervosa =
      recode_factor(mhd.narrow_anorexia_nervosa_numeric,
                    "0" = "No narrow anorexia nervosa",
                    "1" = "Narrow anorexia nervosa",
                    missing = NA_character_
                    )
  )
dat %>%
  freq(mhd.narrow_anorexia_nervosa,
       cumul = F)
}
```

```{r mhd broad_anorexia_nervosa}
if(GLAD == TRUE | EDGI == TRUE | NBR == TRUE | RAMP == TRUE) {
dat <- dat %>%
  mutate(
    mhd.broad_anorexia_nervosa_numeric = 
      case_when(
        mhd.an_numeric == "1" &
        mhd.atypical_an_numeric == "1" ~ 1,
        (mhd.an_numeric == "0" |
        mhd.atypical_an_numeric == "0") ~ 0
    )
  )
dat <- dat %>%
  mutate(
    mhd.broad_anorexia_nervosa =
      recode_factor(mhd.broad_anorexia_nervosa_numeric,
                    "0" = "No broad anorexia nervosa",
                    "1" = "Broad anorexia nervosa",
                    missing = NA_character_
                    )
  )
dat %>%
  freq(mhd.broad_anorexia_nervosa,
       cumul = F)
}
```

```{r mhd atypical_anorexia_nervosa}
if(GLAD == TRUE | EDGI == TRUE | NBR == TRUE | RAMP == TRUE) {
dat <- dat %>%
  mutate(
    mhd.atypical_anorexia_nervosa_numeric = 
      case_when(
        mhd.atypical_an_numeric == 1 & mhd.an_numeric == 0 ~ 1,
        mhd.atypical_an_numeric == 0 | mhd.an_numeric == 1 ~ 0
      )
  )
dat <- dat %>%
  mutate(
    mhd.atypical_anorexia_nervosa =
      recode_factor(mhd.atypical_anorexia_nervosa_numeric,
                    "0" = "No atypical anorexia nervosa",
                    "1" = "Atypical anorexia nervosa",
                    missing = NA_character_
                    )
  )
dat %>%
  freq(mhd.atypical_anorexia_nervosa,
       cumul = F)
}
```

```{r Check mhd anorexia nervosa}
if(GLAD == TRUE | EDGI == TRUE | NBR == TRUE | RAMP == TRUE) {
dat %>%
  select(
    mhd.anorexia_nervosa,
    mhd.narrow_anorexia_nervosa,
    mhd.broad_anorexia_nervosa,
    mhd.atypical_anorexia_nervosa,
    mhd.atypical_an,
    mhd.an,
  )
}
```

```{r mhd bulimia_nervosa}
if(GLAD == TRUE | NBR == TRUE | RAMP == TRUE) {
dat <- dat %>%
  mutate(
    mhd.bulimia_nervosa_numeric =
      case_when(
        mhd.bn_numeric == "1" ~ 1,
        (mhd.bn_numeric == "0") ~ 0
      )
  )
dat <- dat %>%
  mutate(
    mhd.bulimia_nervosa =
      recode_factor(mhd.bulimia_nervosa_numeric,
                    "0" = "No bulimia nervosa",
                    "1" = "Bulimia_nervosa",
                    missing = NA_character_
                    )
  )
dat %>%
  freq(mhd.bulimia_nervosa,
       cumul = F)
}
```
We assume that participants how did not endorse bulimia nervosa in GLAD may
also not have an atypical bulimia nervosa. Therefore, we treated NA for atypical
bulimia nervosa in GLAD (as the answer option atypical BN was not presented) in
GLAD as 0 (= not having bulimia nervosa)
```{r edgi mhd bulimia_nervosa}
if(EDGI == TRUE) {
dat <- dat %>%
  mutate(
    mhd.bulimia_nervosa_numeric =
      case_when(
        mhd.bn_numeric == "1" ~ 1,
        mhd.atypical_bn_numeric == "1" ~ 1, # additional diagnosis in EDGI but not in GLAD
        (mhd.bn_numeric == "0" &
        (mhd.atypical_bn_numeric == "0" | is.na(mhd.atypical_bn_numeric))) ~ 0
      )
  )
dat <- dat %>%
  mutate(
    mhd.bulimia_nervosa =
      recode_factor(mhd.bulimia_nervosa_numeric,
                    "0" = "No bulimia nervosa",
                    "1" = "Bulimia nervosa",
                    missing = NA_character_
                    )
  )
dat %>%
  freq(mhd.bulimia_nervosa,
       cumul = F)
}
```

```{r edgi mhd narrow_bulimia_nervosa}
if(EDGI == TRUE) {
dat <- dat %>%
  mutate(
    mhd.narrow_bulimia_nervosa_numeric =
      case_when(
        mhd.bn_numeric == 1 & (mhd.atypical_bn_numeric == 0 | is.na(mhd.atypical_bn_numeric)) ~ 1,
        mhd.bn_numeric == 0 | mhd.atypical_bn_numeric == 1 ~ 0
      )
  )
dat <- dat %>%
  mutate(
    mhd.narrow_bulimia_nervosa =
      recode_factor(mhd.narrow_bulimia_nervosa_numeric,
                    "0" = "No narrow bulimia nervosa",
                    "1" = "Narrow bulimia nervosa",
                    missing = NA_character_
                    )
  )
dat %>%
  freq(mhd.narrow_bulimia_nervosa,
       cumul = F)
}
```

```{r edgi mhd broad_bulimia_nervosa}
if(EDGI == TRUE) {
dat <- dat %>%
  mutate(
    mhd.broad_bulimia_nervosa_numeric = 
      case_when(
        mhd.bn_numeric == "1" &
        mhd.atypical_bn_numeric == "1" ~ 1,
        (mhd.bn_numeric == "0" |
        mhd.atypical_bn_numeric == "0" | 
        is.na(mhd.atypical_bn_numeric)) ~ 0
    )
  )
dat <- dat %>%
  mutate(
    mhd.broad_bulimia_nervosa =
      recode_factor(mhd.broad_bulimia_nervosa_numeric,
                    "0" = "No broad bulimia nervosa",
                    "1" = "Broad bulimia nervosa",
                    missing = NA_character_
                    )
  )
dat %>%
  freq(mhd.broad_bulimia_nervosa,
       cumul = F)
}
```

```{r edgi mhd atypical_bulimia_nervosa}
if(EDGI == TRUE) {
dat <- dat %>%
  mutate(
    mhd.atypical_bulimia_nervosa_numeric =
      case_when(
        mhd.atypical_bn_numeric == "1" & 
        mhd.bn_numeric == "0" ~ 1,
        (mhd.atypical_bn_numeric == "0" | 
        is.na(mhd.atypical_bn_numeric)) |
        mhd.bn_numeric == 1 ~ 0
      )
  )
dat <- dat %>%
  mutate(
    mhd.atypical_bulimia_nervosa =
      recode_factor(mhd.atypical_bulimia_nervosa_numeric,
                    "0" = "No atypical bulimia nervosa",
                    "1" = "Atypical bulimia nervosa",
                    missing = NA_character_
                    )
  )
dat %>%
  freq(mhd.atypical_bulimia_nervosa,
       cumul = F)
}
```

```{r Check bulimia nervosa}
if(GLAD == TRUE | NBR == TRUE | RAMP == TRUE) {
dat %>%
  select(
    mhd.bulimia_nervosa,
    mhd.narrow_bulimia_nervosa,
    mhd.broad_bulimia_nervosa,
    mhd.atypical_bulimia_nervosa,
    mhd.atypical_bn,
    mhd.bn,
  )
}
```

```{r mhd binge_eating_disorder}
if(GLAD == TRUE | NBR == TRUE | RAMP == TRUE) {
dat <- dat %>%
  mutate(
    mhd.binge_eating_disorder_numeric =
      case_when(
        mhd.bed_numeric == "1" ~ 1,
        (mhd.bed_numeric == "0") ~ 0
      )
  )
dat <- dat %>%
  mutate(
    mhd.binge_eating_disorder =
      recode_factor(mhd.binge_eating_disorder_numeric,
                    "0" = "No binge eating disorder",
                    "1" = "Binge eating disorder",
                    missing = NA_character_
                    )
  )
dat %>%
  freq(mhd.binge_eating_disorder,
       cumul = F)
}
```
We assume that participants how did not endorse binge eating disorder in GLAD may
also not have an atypical binge eating disorder. Therefore, we treated NA for atypical
binge eating disorder in GLAD (as the answer option atypical BED was not presented) in
GLAD as 0 (= not having binge eating disorder)
```{r edgi mhd binge_eating_disorder}
if(EDGI == TRUE) {
dat <- dat %>%
  mutate(
    mhd.binge_eating_disorder_numeric =
      case_when(
        mhd.bed_numeric == "1" ~ 1,
        mhd.atypical_bed_numeric == "1" ~ 1, # additional diagnosis in EDGI
        (mhd.bed_numeric == "0" &
        (mhd.atypical_bed_numeric == "0"| is.na(mhd.atypical_bed_numeric))) ~ 0
      )
  )
dat <- dat %>%
  mutate(
    mhd.binge_eating_disorder =
      recode_factor(mhd.binge_eating_disorder_numeric,
                    "0" = "No binge eating disorder",
                    "1" = "Binge eating disorder",
                    missing = NA_character_
                    )
  )
dat %>%
  freq(mhd.binge_eating_disorder,
       cumul = F)
}
```

```{r edgi mhd narrow_binge_eating_disorder}
if(EDGI == TRUE) {
dat <- dat %>%
  mutate(
    mhd.narrow_binge_eating_disorder_numeric =
      case_when(
        mhd.bed_numeric == 1 & (mhd.atypical_bed_numeric == 0 | is.na(mhd.atypical_bed_numeric)) ~ 1,
        mhd.bed_numeric == 0 | mhd.atypical_bed_numeric == 1 ~ 0
      )
  )
dat <- dat %>%
  mutate(
    mhd.narrow_binge_eating_disorder =
      recode_factor(mhd.narrow_binge_eating_disorder_numeric,
                    "0" = "No narrow binge eating disorder",
                    "1" = "Narrow binge eating disorder",
                    missing = NA_character_
                    )
  )
dat %>%
  freq(mhd.narrow_binge_eating_disorder,
       cumul = F)
}
```

```{r edgi mhd broad_binge_eating_disorder}
if(EDGI == TRUE) {
dat <- dat %>%
  mutate(
    mhd.broad_binge_eating_disorder_numeric = 
      case_when(
        mhd.bed_numeric == "1" &
        mhd.atypical_bed_numeric == "1" ~ 1,
        (mhd.bed_numeric == "0" |
        mhd.atypical_bed_numeric == "0" |
        is.na(mhd.atypical_bed_numeric)) ~ 0
    )
  )
dat <- dat %>%
  mutate(
    mhd.broad_binge_eating_disorder =
      recode_factor(mhd.broad_binge_eating_disorder_numeric,
                    "0" = "No broad binge eating disorder",
                    "1" = "Broad binge eating disorder",
                    missing = NA_character_
                    )
  )
dat %>%
  freq(mhd.broad_binge_eating_disorder,
       cumul = F)
}
```

```{r edgi mhd atypical_binge_eating_disorder}
if(EDGI == TRUE) {
dat <- dat %>%
  mutate(
    mhd.atypical_binge_eating_disorder_numeric =
      case_when(
        mhd.atypical_bed_numeric == "1" & 
        mhd.bed_numeric == "0" ~ 1,
        mhd.atypical_bed_numeric == "0" | 
        is.na(mhd.atypical_bed_numeric) | 
        mhd.bed_numeric == "1" ~ 0
      )
  )
dat <- dat %>%
  mutate(
    mhd.atypical_binge_eating_disorder =
      recode_factor(mhd.atypical_binge_eating_disorder_numeric,
                    "0" = "No atypical binge eating disorder",
                    "1" = "Atypical binge eating disorder",
                    missing = NA_character_
                    )
  )
dat %>%
  freq(mhd.atypical_binge_eating_disorder,
       cumul = F)
}
```

```{r Check binge eating disorders}
if(EDGI == TRUE) {
dat %>%
  select(
    mhd.binge_eating_disorder,
    mhd.narrow_binge_eating_disorder,
    mhd.narrow_binge_eating_disorder_numeric,
    mhd.broad_binge_eating_disorder,
    mhd.atypical_binge_eating_disorder,
    mhd.atypical_bed,
    mhd.bed,
  )
}
```

Eating disorders with binge eating vs eating disorders without
Caveat: Anorexia nervosa can have binge eating as well. Therefore, this would need an additional variable from the ED100K to define a "restricting" only anorexia nervosa subtype
```{r mhd eating_disorders_restricting_vs_binge_eating}
if(GLAD == TRUE | NBR == TRUE | RAMP == TRUE) {
dat <- dat %>%
  mutate(
    mhd.eating_disorders_restricting_vs_binge_eating_numeric =
      case_when(
        mhd.an_numeric == "1" ~ 1,
        mhd.atypical_an_numeric == "1" ~ 1,
        mhd.bn_numeric == "1" ~ 2,
        mhd.bed_numeric == "1" ~ 2,
        (mhd.an_numeric == "0" &
        mhd.atypical_an_numeric == "0" &
        mhd.bn_numeric == "0" &
        mhd.bed_numeric == "0") ~ 0
      )
  )
dat <- dat %>%
  mutate(
    mhd.eating_disorders_restricting_vs_binge_eating =
      recode_factor(mhd.eating_disorders_restricting_vs_binge_eating_numeric,
                    "0" = "No eating disorder",
                    "1" = "Anorexia nervosa",
                    "2" = "Eating disorder with binge eating",
                    missing = NA_character_
                    )
  )
dat %>%
  freq(mhd.eating_disorders_restricting_vs_binge_eating,
       cumul = F)
}
```

```{r EDGI mhd.eating_disorders_restricting_vs_binge_eating}
if(EDGI == TRUE) {
dat <- dat %>%
  mutate(
    mhd.eating_disorders_restricting_vs_binge_eating_numeric =
      case_when(
        mhd.an_numeric == "1" ~ 1,
        mhd.atypical_an_numeric == "1" ~ 1,
        mhd.bn_numeric == "1" ~ 2,
        mhd.atypical_bn_numeric == "1" ~ 2, # additional diagnosis in EDGI but not in GLAD
        mhd.bed_numeric == "1" ~ 2,
        mhd.atypical_bed_numeric == "1" ~ 2, # additional diagnosis in EDGI
        (mhd.an_numeric == "0" &
        mhd.atypical_an_numeric == "0" &
        mhd.bn_numeric == "0" &
        (mhd.atypical_bn_numeric == "0" | is.na(mhd.atypical_bed_numeric)) &
        mhd.bed_numeric == "0" &
        (mhd.atypical_bed_numeric == "0" | is.na(mhd.atypical_bed_numeric))) ~ 0
      )
  )
dat <- dat %>%
  mutate(
    mhd.eating_disorders_restricting_vs_binge_eating =
      recode_factor(mhd.eating_disorders_restricting_vs_binge_eating_numeric,
                    "0" = "No eating disorder",
                    "1" = "Anorexia nervosa",
                    "2" = "Eating disorder with binge eating",
                    missing = NA_character_
                    )
  )
dat %>%
  freq(mhd.eating_disorders_restricting_vs_binge_eating,
       cumul = F)
}
```

```{r Check eating_disorders}
if(GLAD == TRUE | NBR == TRUE | RAMP == TRUE) {
dat %>%
  select(
    mhd.eating_disorders,
    mhd.eating_disorders_numeric,
    mhd.eating_disorders_restricting_vs_binge_eating,
    mhd.eating_disorders_restricting_vs_binge_eating_numeric,
    mhd.an,
    mhd.atypical_an,
    mhd.anorexia_nervosa,
    mhd.bn,
    mhd.bulimia_nervosa,
    mhd.bed,
    mhd.binge_eating_disorder
  )
}
```

```{r EDGI Check eating_disorders}
if(EDGI == TRUE) {
dat %>%
  select(
    mhd.eating_disorders,
    mhd.eating_disorders_numeric,
    mhd.eating_disorders_restricting_vs_binge_eating,
    mhd.eating_disorders_restricting_vs_binge_eating_numeric,
    mhd.an,
    mhd.atypical_an,
    mhd.anorexia_nervosa,
    mhd.bn,
    mhd.atypical_bn,
    mhd.bulimia_nervosa,
    mhd.bed,
    mhd.atypical_bed,
    mhd.binge_eating_disorder
  )
}
```



### Obsessive compulsive disorders
Be careful mhd.obsessive_compulsive_disorders and mhd.obsessive_compulsive_disorder only differ by one s
```{r mhd obsessive_compulsive_disorders}
if(GLAD == TRUE | EDGI == TRUE | NBR == TRUE) {
dat <- dat %>%
  mutate(
    mhd.obsessive_compulsive_disorders_numeric =
      case_when(
        mhd.ocd_numeric == "1" ~ 1,
        mhd.other_ocd_numeric == "1" ~ 1,
        mhd.bdd_numeric == "1" ~ 1,
        (mhd.ocd_numeric == "0" &
        mhd.other_ocd_numeric == "0" &
        mhd.bdd_numeric == "0") ~ 0
      )
  )
dat <- dat %>%
  mutate(
    mhd.obsessive_compulsive_disorders =
      recode_factor(mhd.obsessive_compulsive_disorders_numeric,
                    "0" = "No obsessive compulsive disorder",
                    "1" = "Obsessive compulsive disorder",
                    missing = NA_character_
                    )
  )
dat %>%
  freq(mhd.obsessive_compulsive_disorders)
}
```
Be careful mhd.obsessive_compulsive_disorders and mhd.obsessive_compulsive_disorder only differ by one s
```{r mhd obsessive_compulsive_disorders for ramp}
if(RAMP == TRUE) {
dat <- dat %>%
  mutate(
    mhd.obsessive_compulsive_disorders_numeric =
      case_when(
        mhd.ocd_numeric == "1" ~ 1,
        mhd.other_ocd_numeric == "1" ~ 1,
        mhd.bdd_numeric == "1" ~ 1,
        (mhd.ocd_numeric == "0" &
        mhd.other_ocd_numeric == "0" &
        mhd.bdd_numeric == "0") ~ 0
      )
  )
dat <- dat %>%
  mutate(
    mhd.obsessive_compulsive_disorders =
      recode_factor(mhd.obsessive_compulsive_disorders_numeric,
                    "0" = "No obsessive compulsive disorder",
                    "1" = "Obsessive compulsive disorder",
                    missing = NA_character_
                    )
  )
dat %>%
  freq(mhd.obsessive_compulsive_disorders)
}
```

Be careful mhd.obsessive_compulsive_disorders and mhd.obsessive_compulsive_disorder only differ by one s
```{r mhd obsessive_compulsive_disorder}
if(GLAD == TRUE | EDGI == TRUE | NBR == TRUE) {
dat <- dat %>%
  mutate(
    mhd.obsessive_compulsive_disorder_numeric =
      case_when(
        mhd.ocd_numeric == "1" ~ 1,
        mhd.other_ocd_numeric == "1" ~ 1,
        (mhd.ocd_numeric == "0" &
        mhd.other_ocd_numeric == "0") ~ 0
      )
  )
dat <- dat %>%
  mutate(
    mhd.obsessive_compulsive_disorder =
      recode_factor(mhd.obsessive_compulsive_disorder_numeric,
                    "0" = "No obsessive compulsive disorder",
                    "1" = "Obsessive compulsive disorder",
                    missing = NA_character_
                    )
  )
dat %>%
  freq(mhd.obsessive_compulsive_disorder)
}
```

```{r mhd body_dysmorphic_disorder}
if(GLAD == TRUE | EDGI == TRUE | NBR == TRUE) {
dat <- dat %>%
  mutate(
    mhd.body_dysmorphic_disorder_numeric =
      case_when(
        mhd.bdd_numeric == "1" ~ 1,
        (mhd.bdd_numeric == "0") ~ 0
      )
  )
dat <- dat %>%
  mutate(
    mhd.body_dysmorphic_disorder =
      recode_factor(mhd.obsessive_compulsive_disorders_numeric,
                    "0" = "No body dysmorphic disorder",
                    "1" = "Body dysmorphic disorder",
                    missing = NA_character_
                    )
  )
dat %>%
  freq(mhd.body_dysmorphic_disorder)
}
```

```{r Check obsessive_compulsive_disorders}
if(GLAD == TRUE | EDGI == TRUE | NBR == TRUE) {
dat %>%
  select(
    mhd.obsessive_compulsive_disorders,
    mhd.obsessive_compulsive_disorders_numeric,
    mhd.ocd,
    mhd.other_ocd,
    mhd.obsessive_compulsive_disorder,
    mhd.obsessive_compulsive_disorder_numeric,
    mhd.bdd,
    mhd.body_dysmorphic_disorder,
    mhd.body_dysmorphic_disorder_numeric
  )
}
```

```{r Check obsessive_compulsive_disorders ramp}
if(RAMP == TRUE) {
dat %>%
  select(
    mhd.obsessive_compulsive_disorders,
    mhd.obsessive_compulsive_disorders_numeric,
    mhd.ocd,
    mhd.other_ocd,
    mhd.bdd
  )
}
```

### Psychotic disorders
"mhd.schizophrenia_numeric"
"mhd.schizoaffective_numeric"
"mhd.psychosis_numeric"
```{r mhd psychotic_disorders}
if(GLAD == TRUE | EDGI == TRUE | NBR == TRUE | RAMP == TRUE) {
dat <- dat %>%
  mutate(
    mhd.psychotic_disorders_numeric =
      case_when(
        mhd.schizophrenia_numeric == "1" ~ 1,
        mhd.schizoaffective_numeric == "1" ~ 1,
        mhd.psychosis_numeric == "1" ~ 1,
        (mhd.schizophrenia_numeric == "0" &
        (mhd.schizoaffective_numeric == "0" | is.na(mhd.schizoaffective_numeric)) & #NA included because some cohorts don't have schizoaffective disorder
        mhd.psychosis_numeric == "0") ~ 0)
        )

dat <- dat %>%
  mutate(
    mhd.psychotic_disorders =
      recode_factor(mhd.psychotic_disorders_numeric,
                    "0" = "No psychotic disorder",
                    "1" = "Psychotic disorder",
                    missing = NA_character_
                    )
  )
dat %>%
  freq(mhd.psychotic_disorders)
}
```


Overlap between self-report schizophrenia and bipolar disorder
+++CH: Check overlap between schizophrenia group and bipolar disorder
++KT: Only 63 with comorbid self-report bipolar disorder and schizophrenia. More likely to have shared symptoms, less likely to have confirmed diagnoses of both. Could be too severe to be in GLAD?
```{r mhd bipolar_and_schizophrenia_numeric}
if(GLAD == TRUE | EDGI == TRUE | NBR == TRUE | RAMP == TRUE) {
dat <- dat %>%
  mutate(
    mhd.bipolar_and_schizophrenia_numeric =
      case_when(
        mhd.psychotic_disorders_numeric == 0 &
          mhd.bipolar_disorder_numeric == 0 ~ 0,
        mhd.psychotic_disorders_numeric == 1 &
          mhd.bipolar_disorder_numeric == 1 ~ 1,
        mhd.psychotic_disorders_numeric == 1 &
          mhd.bipolar_disorder_numeric == 0 ~ 2,
        mhd.psychotic_disorders_numeric == 0 &
          mhd.bipolar_disorder_numeric == 1 ~ 3
      )
  )
dat <- dat %>%
  mutate(
    mhd.bipolar_and_schizophrenia =
      recode_factor(mhd.bipolar_and_schizophrenia_numeric,
                    "0" = "No psychotic or bipolar disorder",
                    "1" = "Psychotic and bipolar disorder",
                    "2" = "Only psychotic disorder",
                    "3" = "Only bipolar disorder",
                    missing = NA_character_
                    )
  )
dat %>%
  freq(mhd.bipolar_and_schizophrenia,
       cumul = F)
}
```

```{r Check psychotic_disorders}
if(GLAD == TRUE | EDGI == TRUE | NBR == TRUE | RAMP == TRUE) {
dat %>%
  select(
    mhd.psychotic_disorders,
    mhd.bipolar_and_schizophrenia,
    mhd.schizophrenia_numeric,
    mhd.schizoaffective_numeric,
    mhd.psychosis_numeric,
    mhd.bipolar_disorder_numeric
  )
}
```

### Autism spectrum disorder
```{r mhd autism_spectrum_disorder}
if(GLAD == TRUE | EDGI == TRUE | NBR == TRUE | RAMP == TRUE){
  dat <- dat %>%
    mutate(
      mhd.autism_spectrum_disorder_numeric =
        case_when(
          mhd.asd_numeric == 0 ~ 0,
          mhd.asd_numeric == 1 ~ 1
        )
    )
  dat <- dat %>%
    mutate(
      mhd.autism_spectrum_disorder =
        recode_factor(
          mhd.autism_spectrum_disorder_numeric,
          `0` = "No autism spectrum disorder",
          `1` = "Autism spectrum disorder"
        )
    )
  dat %>%
    freq(mhd.autism_spectrum_disorder)
}
```

```{r Check autism_spectrum_disorder}
if(GLAD == TRUE | EDGI == TRUE | NBR == TRUE | RAMP == TRUE) {
dat %>%
  select(
    mhd.autism_spectrum_disorder,
    mhd.autism_spectrum_disorder_numeric,
    mhd.asd,
    mhd.asd_numeric
  ) %>%
    filter(mhd.autism_spectrum_disorder == "Autism spectrum disorder")
}
```


### Personality disorders
++KT: For all cluster coding chunks - have added other clusters as == 0, so that they are not coerced into NAs.
Cluster A
1. Paranoid                         28 ( 1.0%)
2. Schizoid                         15 ( 0.5%)
3. Schizotypal                      14 ( 0.5%)
```{r mhd personality_cluster_a}
if(GLAD == TRUE | NBR == TRUE | RAMP == TRUE) {
dat <- dat %>%
  mutate(
    mhd.personality_cluster_a_numeric =
      case_when(
        mhd.personality_disorder_diagnosed_numeric == "1" ~ 1,
        mhd.personality_disorder_diagnosed_numeric == "2" ~ 1,
        mhd.personality_disorder_diagnosed_numeric == "3" ~ 1,
        mhd.personality_disorder_diagnosed_numeric == "4" ~ 0,
        mhd.personality_disorder_diagnosed_numeric == "5" ~ 0,
        mhd.personality_disorder_diagnosed_numeric == "6" ~ 0,
        mhd.personality_disorder_diagnosed_numeric == "7" ~ 0,
        mhd.personality_disorder_diagnosed_numeric == "8" ~ 0,
        mhd.personality_disorder_diagnosed_numeric == "9" ~ 0,
        mhd.personality_disorder_diagnosed_numeric == "10" ~ 0,
        mhd.personality_disorder_numeric == "0" ~ 0
      )
  )
dat <- dat %>%
  mutate(
    mhd.personality_cluster_a =
      recode_factor(mhd.personality_cluster_a_numeric,
                    "0" = "No personality disorder cluster A",
                    "1" = "Personality disorder cluster A",
                    missing = NA_character_
                    )
  )
dat %>%
  freq(mhd.personality_cluster_a,
       cumul = F)
}
```

```{r Check personality_cluster_a}
if(GLAD == TRUE | NBR == TRUE | RAMP == TRUE) {
dat %>%
  select(
    mhd.personality_cluster_a,
    mhd.personality_cluster_a_numeric,
    mhd.personality_disorder_diagnosed,
    mhd.personality_disorder_diagnosed_numeric
  )
}
```

Cluster B
4. Antisocial                       24 ( 0.8%)
5. Borderline                     2553 (89.4%)
6. Histrionic                        7 ( 0.2%)
7. Narcissistic                      8 ( 0.3%)

```{r mhd personality_cluster_b}
if(GLAD == TRUE | NBR == TRUE | RAMP == TRUE) {
dat <- dat %>%
  mutate(
    mhd.personality_cluster_b_numeric =
      case_when(
        mhd.personality_disorder_diagnosed_numeric == "1" ~ 0,
        mhd.personality_disorder_diagnosed_numeric == "2" ~ 0,
        mhd.personality_disorder_diagnosed_numeric == "3" ~ 0,
        mhd.personality_disorder_diagnosed_numeric == "4" ~ 1,
        mhd.personality_disorder_diagnosed_numeric == "5" ~ 1,
        mhd.personality_disorder_diagnosed_numeric == "6" ~ 1,
        mhd.personality_disorder_diagnosed_numeric == "7" ~ 1,
        mhd.personality_disorder_diagnosed_numeric == "8" ~ 0,
        mhd.personality_disorder_diagnosed_numeric == "9" ~ 0,
        mhd.personality_disorder_diagnosed_numeric == "10" ~ 0,
        mhd.personality_disorder_numeric == "0" ~ 0
      )
  )
dat <- dat %>%
  mutate(
    mhd.personality_cluster_b =
      recode_factor(mhd.personality_cluster_b_numeric,
                    "0" = "No personality disorder cluster B",
                    "1" = "Personality disorder cluster B",
                    missing = NA_character_
                    )
  )
dat %>%
  freq(mhd.personality_cluster_b,
       cumul = F)
}
```

```{r Check personality_cluster_b}
if(GLAD == TRUE | NBR == TRUE | RAMP == TRUE) {
dat %>%
  select(
    mhd.personality_cluster_b,
    mhd.personality_cluster_b_numeric,
    mhd.personality_disorder_diagnosed,
    mhd.personality_disorder_diagnosed_numeric
  )
}
```

Cluster C
8. Avoidant/anxious                133 ( 4.7%)
9. Dependent                        29 ( 1.0%)
10. Obsessive-compulsive
```{r glad mhd personality_cluster_c}
if(GLAD == TRUE | NBR == TRUE | RAMP == TRUE) {
dat <- dat %>%
  mutate(
    mhd.personality_cluster_c_numeric =
      case_when(
        mhd.personality_disorder_diagnosed_numeric == "1" ~ 0,
        mhd.personality_disorder_diagnosed_numeric == "2" ~ 0,
        mhd.personality_disorder_diagnosed_numeric == "3" ~ 0,
        mhd.personality_disorder_diagnosed_numeric == "4" ~ 0,
        mhd.personality_disorder_diagnosed_numeric == "5" ~ 0,
        mhd.personality_disorder_diagnosed_numeric == "6" ~ 0,
        mhd.personality_disorder_diagnosed_numeric == "7" ~ 0,
        mhd.personality_disorder_diagnosed_numeric == "8" ~ 1,
        mhd.personality_disorder_diagnosed_numeric == "9" ~ 1,
        mhd.personality_disorder_diagnosed_numeric == "10" ~ 1,
        mhd.personality_disorder_numeric == "0" ~ 0
      )
  )
dat <- dat %>%
  mutate(
    mhd.personality_cluster_c =
      recode_factor(mhd.personality_cluster_c_numeric,
                    "0" = "No personality disorder cluster C",
                    "1" = "Personality disorder cluster C",
                    missing = NA_character_
                    )
  )
dat %>%
  freq(mhd.personality_cluster_c,
       cumul = F)
}
```

```{r Check personality_cluster_c}
if(GLAD == TRUE | NBR == TRUE | RAMP == TRUE) {
dat %>%
  select(
    mhd.personality_cluster_c,
    mhd.personality_cluster_c_numeric,
    mhd.personality_disorder_diagnosed,
    mhd.personality_disorder_diagnosed_numeric
  )
}
```

### Controls
These individuals have no self report diagnosis of any kind that we measure.
```{r mhd control GLAD RAMP}
if(GLAD == TRUE | RAMP == TRUE) {
dat <- dat %>%
  mutate(
    mhd.control_numeric =
      if_else(
    mhd.depressive_disorders_numeric == "0" &
    mhd.anxiety_disorders_numeric == "0" &
    mhd.eating_disorders_numeric == "0" &
    mhd.obsessive_compulsive_disorders_numeric == "0" &
    mhd.psychotic_disorders_numeric == "0" &
    mhd.bipolar_disorder_numeric == "0" &
    mhd.ptsd_numeric == "0" &
    mhd.autism_spectrum_disorder_numeric == "0" &
    mhd.addadhd_numeric == "0" &
    mhd.personality_disorder_numeric == "0" &
      mhd.pnta_dep_anx_ocd_ptsd_numeric == "0" &
      mhd.pnta_neuro_eds_numeric == "0" &
      mhd.dont_know_dep_anx_ocd_ptsd_numeric == "0" &
      mhd.dont_know_neuro_eds_numeric == "0" &
      mhd.other_numeric == "0",
    true = 1,
    false = 0,
    NA_real_)
  )
dat <- dat %>%
  mutate(
    mhd.control =
      recode_factor(mhd.control_numeric,
                    "0" = "No control",
                    "1" = "Control",
                    missing = NA_character_
                    )
  )
dat %>%
  freq(mhd.control,
       cumul = F)
}
```

```{r mhd control EDGI NBR}
if(EDGI == TRUE | NBR == TRUE) {
dat <- dat %>%
  mutate(
    mhd.control_numeric =
      if_else(
    mhd.depressive_disorders_numeric == "0" &
    mhd.anxiety_disorders_numeric == "0" &
    mhd.eating_disorders_numeric == "0" &
    mhd.obsessive_compulsive_disorders_numeric == "0" &
    mhd.psychotic_disorders_numeric == "0" &
    mhd.bipolar_disorder_numeric == "0" &
    mhd.ptsd_numeric == "0" &
    mhd.autism_spectrum_disorder_numeric == "0" &
    mhd.addadhd_numeric == "0" &
    mhd.personality_disorder_numeric == "0" &
      mhd.pnta_dep_anx_ocd_ptsd_numeric == "0" &
      mhd.pnta_neuro_numeric == "0" &
      mhd.dont_know_dep_anx_ocd_ptsd_numeric == "0" &
      mhd.dont_know_neuro_numeric == "0" &
      mhd.other_numeric == "0" &
      mhd.dont_know_eds_numeric == "0" &
      mhd.pnta_eds_numeric == "0" &
      mhd.other_eating_disorder_numeric == "0",
    true = 1,
    false = 0,
    NA_real_)
  )
dat <- dat %>%
  mutate(
    mhd.control =
      recode_factor(mhd.control_numeric,
                    "0" = "No control",
                    "1" = "Control",
                    missing = NA_character_
                    )
  )
dat %>%
  freq(mhd.control,
       cumul = F)
}
```


```{r RAMP mhd check none of the above}
if(RAMP == TRUE) {
dat %>%
  select(
    mhd.control,
    mhd.none_dep_anx_ocd_ptsd,
    mhd.none_neuro_eds
  )
dat %>%
  group_by(mhd.control) %>%
  count(
    mhd.none_dep_anx_ocd_ptsd,
    mhd.none_neuro_eds,
    mhd.other
  )
}
```

```{r NBR EDGI mhd check none of the above}
if(NBR == TRUE | EDGI == TRUE) {
dat %>%
  group_by(mhd.control) %>%
  count(
    mhd.none_eds,
    mhd.none_neuro,
    mhd.none_dep_anx_ocd_ptsd,
    mhd.other,
    mhd.other_eating_disorder
  )
}
```


Inspect the participants that do not qualify as double "None of these"
```{r RAMP none of these comparison}
if(RAMP == TRUE) {
dat %>%
  filter(
    (mhd.none_dep_anx_ocd_ptsd == "Not None of these" |
    mhd.none_neuro_eds == "Not None of these") &
      mhd.control == "Control"
  ) %>%
    select(
      mhd.none_dep_anx_ocd_ptsd_numeric,
      mhd.dont_know_dep_anx_ocd_ptsd_numeric,
      mhd.pnta_dep_anx_ocd_ptsd_numeric,
      mhd.none_neuro_eds_numeric,
      mhd.dont_know_neuro_eds_numeric,
      mhd.pnta_neuro_eds_numeric,
      mhd.other_numeric
      )
}
```


```{r Check control columns}
if(GLAD == TRUE | NBR == TRUE | RAMP == TRUE) {
dat %>%
  select(
    mhd.control,
    mhd.depressive_disorders_numeric,
    mhd.anxiety_disorders_numeric,
    mhd.eating_disorders_numeric,
    mhd.obsessive_compulsive_disorders_numeric,
    mhd.psychotic_disorders_numeric,
    mhd.bipolar_disorder_numeric,
    mhd.ptsd_numeric,
    mhd.autism_spectrum_disorder_numeric,
    mhd.addadhd_numeric,
    mhd.personality_disorder_numeric
  )
}
```



## Total disorder count
```{r disorders_total_count}
disorder_columns <- c(
    "mhd.depressive_disorders_numeric",
    "mhd.anxiety_disorders_numeric",
    "mhd.eating_disorders_numeric",
    "mhd.obsessive_compulsive_disorders_numeric",
    "mhd.psychotic_disorders_numeric",
    "mhd.bipolar_disorder_numeric",
    "mhd.ptsd_numeric",
    "mhd.autism_spectrum_disorder_numeric",
    "mhd.addadhd_numeric",
    "mhd.personality_disorder_numeric"
)
dat <- dat %>%
  mutate(
    mhd.disorders_total_count =
      rowSums(.[disorder_columns])
  )
dat %>%
  freq(mhd.disorders_total_count,
       cumul = F)
```

## Comorbidity count
```{r cormorbidity_total_count}
dat <- dat %>%
  mutate(
    mhd.comorbidity_total_count_numeric =
      case_when(
        mhd.disorders_total_count == 1 ~ 0,
        mhd.disorders_total_count > 1 ~ mhd.disorders_total_count - 1
  )
  )
dat %>%
  freq(mhd.comorbidity_total_count_numeric,
       cumul = F)
```

```{r comordbitiy_total_count_factor}
dat <- dat %>%
  mutate(
    mhd.comorbidity_total_count_factor_numeric =
      case_when(
    mhd.comorbidity_total_count_numeric == "0" ~ 0,
    mhd.comorbidity_total_count_numeric == "1" ~ 1,
    mhd.comorbidity_total_count_numeric == "2" ~ 2,
    mhd.comorbidity_total_count_numeric > 2 ~ 3
    )
  )
dat <- dat %>%
  mutate(
    mhd.comorbidity_total_count_factor =
      recode_factor(mhd.comorbidity_total_count_factor_numeric,
                    "0" = "No comorbidity",
                    "1" = "1 comorbid disorder",
                    "2" = "2 comorbid disorders",
                    "3" = "3+ comorbid disorders",
                    missing = NA_character_
                    )
  )
dat %>%
  freq(mhd.comorbidity_total_count_factor,
       cumul = F)
```


# Save cleaned data

Combined object for excluded participants
```{r GLAD EDGI EDGI ED save excluded participants}
glad_edgi_edgi_ed_excluded <- as.data.frame(cbind(glad_excluded, edgi_excluded, edgi_ed_excluded))
glad_edgi_edgi_ed_excluded
```

# GLAD
```{r Write cleaned GLAD variables to a .rds file}
dat %>%
  filter(sample == "GLAD") %>%  # select only GLAD participants
  saveRDS(
    file = paste0(LGBTQ_folder, "/test/mhd_glad_clean.rds")
    )
```

